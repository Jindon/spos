import{a as e,c as t,_ as s,r as a,o,b as l,d as r,e as n,f as i,g as d,n as c,t as u,h as m,i as p,j as h,u as b,k as g,l as f,m as v,p as x,q as y,s as w,w as _,F as I,v as k,x as C,y as F,z as S,A as $,B as P,C as T,D,E as V,G as A,H as M,I as E,J as U,K as N,L as q,M as j,N as R,O as L,P as G,Q as B,R as Y,S as O,T as Z,U as z,V as W,W as X,X as H,Y as Q,Z as K,$ as J,a0 as ee,a1 as te,a2 as se,a3 as ae,a4 as oe,a5 as le,a6 as re,a7 as ne,a8 as ie,a9 as de,aa as ce,ab as ue,ac as me,ad as pe,ae as he,af as be,ag as ge,ah as fe,ai as ve,aj as xe,ak as ye,al as we,am as _e,an as Ie,ao as ke,ap as Ce,aq as Fe,ar as Se}from"./vendor.22f082da.js";var $e=t({modules:{user:{namespaced:!0,state:()=>({authenticated:!1,user:null,shop:null,settings:null}),getters:{authenticated:e=>e.authenticated,user:e=>e.user,shop:e=>e.shop,settings:e=>e.settings},mutations:{SET_AUTHENTICATED(e,t){e.authenticated=t},SET_USER(e,t){e.user=t},SET_SHOP(e,t){e.shop=t},SET_SETTINGS(e,t){e.settings=t}},actions:{authenticate({commit:t}){const s=e.create();return s.defaults.baseURL={}.VITE_APP_API_BASE_URL,s.defaults.withCredentials=!0,s.get("/api/user").then((e=>{t("SET_AUTHENTICATED",!0),t("SET_USER",e.data.user),t("SET_SHOP",e.data.shop),t("SET_SETTINGS",e.data.settings)})).catch((()=>{t("SET_AUTHENTICATED",!1),t("SET_USER",null),t("SET_SHOP",null),t("SET_SETTINGS",null)}))},async login({dispatch:t},s){await e.get("/sanctum/csrf-cookie"),await e.post("/login",s),await t("authenticate")},async logout({commit:t}){await e.post("/logout").then((()=>{t("SET_AUTHENTICATED",!1),t("SET_USER",null)})).catch((e=>{console.log(e)}))}}}}});const Pe={components:{ScaleLoader:s},props:{spinning:{type:Boolean,default:!1}}},Te={class:"relative"},De={key:0,class:"z-40 flex items-center justify-center absolute inset-0 min-w-full min-h-full"};Pe.render=function(e,t,s,u,m,p){const h=a("scale-loader");return o(),l("div",Te,[s.spinning?(o(),l("div",De,[r(h,{loading:s.spinning,height:"30px",width:"10px",color:"#598bf9"},null,8,["loading"])])):n("",!0),i("div",{class:c([s.spinning?"opacity-20":"","z-10"])},[d(e.$slots,"default")],2)])};const Ve={props:{error:String,label:String,labelFor:String,required:Boolean}},Ae={class:"flex flex-col"},Me=["for"],Ee={key:1,class:"form-error"};Ve.render=function(e,t,s,a,r,i){return o(),l("div",Ae,[s.label?(o(),l("label",{key:0,for:s.labelFor,class:c(["form-label",s.required?"required":""])},u(s.label),11,Me)):n("",!0),d(e.$slots,"default"),s.error?(o(),l("span",Ee,u(s.error),1)):n("",!0)])};const Ue=m({components:{Spin:Pe,UserIcon:p,LockClosedIcon:h,FormGroup:Ve},setup(){const e=b(),t=g(),s=f({email:v().required().email(),password:v().required().min(8)}),a=x({validationSchema:s}),{value:o,errorMessage:l}=y("email"),{value:r,errorMessage:n}=y("password"),i=w(!1),d=w(null);return{loading:i,errors:d,email:o,emailError:l,password:r,passwordError:n,login:()=>{a.validate().then((({valid:s})=>{s&&(i.value=!0,d.value=null,e.dispatch("user/login",a.values).then((()=>{t.replace({name:"dashboard"})})).catch((e=>{i.value=!1,422===e.response.status&&(d.value=e.response.data.errors)})))}))}}}}),Ne={class:"min-h-screen md:bg-gray-50 py-4 md:py-16"},qe={class:"p-4 md:p-10 md:border-t-4 md:shadow-lg md:border-gray-800 rounded-md bg-white max-w-md m-auto"},je=i("div",{class:"mb-8"},[i("p",{class:"text-gray-700 text-xl md:text-3xl font-bold"},"Login")],-1),Re={key:0,class:"bg-red-100 text-red-800 px-2 py-3 rounded text-sm font-semibold mb-6"},Le={class:"md:pb-8"},Ge=["disabled"];Ue.render=function(e,t,s,d,m,p){const h=a("FormGroup"),b=a("spin");return o(),l("div",Ne,[i("div",qe,[r(b,{spinning:e.loading},{default:_((()=>[je,e.errors?(o(),l("div",Re,[(o(!0),l(I,null,k(e.errors,((e,t)=>(o(),l("div",{key:t},[(o(!0),l(I,null,k(e,(e=>(o(),l("p",{key:e,class:"text-sm"},u(e),1)))),128))])))),128))])):n("",!0),i("div",Le,[i("form",{onSubmit:t[2]||(t[2]=C(((...t)=>e.login&&e.login(...t)),["prevent"]))},[r(h,{label:"Email","label-for":"email",error:e.emailError,required:""},{default:_((()=>[F(i("input",{id:"email",name:"email","onUpdate:modelValue":t[0]||(t[0]=t=>e.email=t),required:"",class:c(["form-control",e.emailError?"form-control--error":""])},null,2),[[S,e.email]])])),_:1},8,["error"]),r(h,{label:"Password","label-for":"password",error:e.passwordError,required:""},{default:_((()=>[F(i("input",{id:"password",name:"password","onUpdate:modelValue":t[1]||(t[1]=t=>e.password=t),type:"password",required:"",class:c(["form-control",e.passwordError?"form-control--error":""])},null,2),[[S,e.password]])])),_:1},8,["error"]),i("button",{type:"submit",class:"login-btn mt-6",disabled:e.loading},"Login",8,Ge)],32)])])),_:1},8,["spinning"])])])};const Be={components:{LogoutIcon:$,PlusIcon:P,ChartSquareBarIcon:T,ReceiptTaxIcon:D,AdjustmentsIcon:V,CollectionIcon:A,CubeIcon:M},setup(){const e=b(),t=g();return{shop:E((function(){return e.getters["user/shop"]})),logout:()=>{e.dispatch("user/logout").then((()=>{t.replace({name:"login"})})).catch((e=>{console.log(e)}))}}}},Ye={class:"flex flex-col min-h-screen justify-between"},Oe={class:"py-4 px-4"},Ze={class:"font-bold leading-none text-lg"},ze={key:0,class:"text-xs text-gray-400 leading-none tracking-wide uppercase mt-2 font-bold"},We={class:"py-4"},Xe={class:"flex flex-col"},He=U("New Invoice"),Qe=U("Dashboard "),Ke=U("Invoices "),Je=U("Customers "),et=U("Products "),tt=U("Settings "),st={class:"border-t border-gray-200 mt-8 py-4"},at=U(),ot=i("span",{class:"leading-none font-semibold"},"Logout",-1);function lt(e={}){const{immediate:t=!0,onNeedRefresh:s,onOfflineReady:a,onRegistered:o,onRegisterError:l}=e,r=w(!1),n=w(!1);return{updateServiceWorker:function(e={}){const{immediate:t=!1,onNeedRefresh:s,onOfflineReady:a,onRegistered:o,onRegisterError:l}=e;let r,n;if("serviceWorker"in navigator){r=new N("/build/sw.js",{scope:"/build/"}),r.addEventListener("activated",(e=>{e.isUpdate||null==a||a()}));{const e=()=>{null==s||s()};r.addEventListener("waiting",e),r.addEventListener("externalwaiting",e)}r.register({immediate:t}).then((e=>{n=e,null==o||o(e)})).catch((e=>{null==l||l(e)}))}return async(e=!0)=>{e&&(null==r||r.addEventListener("controlling",(e=>{e.isUpdate&&window.location.reload()}))),n&&n.waiting&&await q(n.waiting,{type:"SKIP_WAITING"})}}({immediate:t,onNeedRefresh(){r.value=!0,null==s||s()},onOfflineReady(){n.value=!0,null==a||a()},onRegistered:o,onRegisterError:l}),offlineReady:n,needRefresh:r}}Be.render=function(e,t,s,d,c,m){const p=a("PlusIcon"),h=a("router-link"),b=a("ChartSquareBarIcon"),g=a("ReceiptTaxIcon"),f=a("CollectionIcon"),v=a("CubeIcon"),x=a("AdjustmentsIcon"),y=a("LogoutIcon");return o(),l("nav",Ye,[i("div",null,[i("div",Oe,[i("p",Ze,u(d.shop?d.shop.name:"SPOS"),1),d.shop&&d.shop.gstin?(o(),l("p",ze,u(d.shop.gstin),1)):n("",!0)]),i("div",We,[i("ul",Xe,[r(h,{to:{name:"invoices.create"},class:"flex items-center px-4 py-3 border-t border-b mb-4 hover:bg-blue-500 hover:text-white leading-none transition-all ease-in-out duration-200","active-class":"bg-blue-500 text-white"},{default:_((()=>[r(p,{class:"h-4 w-4 mr-2"}),He])),_:1},8,["to"]),r(h,{to:{name:"dashboard"},class:"flex items-center px-4 py-2 leading-none hover:bg-gray-100 transition-all ease-in-out-200","active-class":"text-gray-900 bg-gray-200"},{default:_((()=>[r(b,{class:"h-5 w-5 mr-3 text-blue-500"}),Qe])),_:1}),r(h,{to:{name:"invoices.list"},class:"flex items-center px-4 py-2 leading-none hover:bg-gray-100 transition-all ease-in-out-200","active-class":"text-gray-900 bg-gray-200"},{default:_((()=>[r(g,{class:"h-5 w-5 mr-3 text-green-500"}),Ke])),_:1},8,["to"]),r(h,{to:{name:"customers.list"},class:"flex items-center px-4 py-2 leading-none hover:bg-gray-100 transition-all ease-in-out-200","active-class":"text-gray-900 bg-gray-200"},{default:_((()=>[r(f,{class:"h-5 w-5 mr-3 text-pink-500"}),Je])),_:1},8,["to"]),r(h,{to:{name:"products.list"},class:"flex items-center px-4 py-2 leading-none hover:bg-gray-100 transition-all ease-in-out-200","active-class":"text-gray-900 bg-gray-200"},{default:_((()=>[r(v,{class:"h-5 w-5 mr-3 text-yellow-500"}),et])),_:1},8,["to"]),r(h,{to:{name:"settings"},class:"flex items-center px-4 py-2 leading-none hover:bg-gray-100 transition-all ease-in-out-200","active-class":"text-gray-900 bg-gray-200"},{default:_((()=>[r(x,{class:"h-5 w-5 mr-3 text-purple-500"}),tt])),_:1})])])]),i("div",st,[i("button",{class:"flex items-center px-4 py-2 text-left hover:text-red-600 transition-all ease-in-out duration-100",onClick:t[0]||(t[0]=C(((...e)=>d.logout&&d.logout(...e)),["prevent"]))},[r(y,{class:"h-5 w-5 mr-2 text-red-500"}),at,ot])])])};const rt={key:0,class:"pwa-toast",role:"alert"},nt={class:"message"},it={key:0},dt={key:1};var ct=m({setup(e){const{offlineReady:t,needRefresh:s,updateServiceWorker:a}=lt(),r=async()=>{t.value=!1,s.value=!1};return(e,d)=>j(t)||j(s)?(o(),l("div",rt,[i("div",nt,[j(t)?(o(),l("span",it," App ready to work offline ")):(o(),l("span",dt," New content available, click on reload button to update. "))]),j(s)?(o(),l("button",{key:0,onClick:d[0]||(d[0]=e=>j(a)())}," Reload ")):n("",!0),i("button",{onClick:r}," Close ")])):n("",!0)}});const ut={components:{XIcon:R,MenuIcon:L,SideNav:Be,ReloadPrompt:ct},props:{maxWidth:{type:String,default:"max-w-4xl"}},setup:()=>({open:w(!1)})},mt={class:"relative flex min-h-screen text-gray-700"},pt={class:"z-40 w-52 fixed inset-0 bg-gray-50 hidden md:block print:hidden"},ht={class:"z-10 md:ml-52 w-full bg-white"},bt={class:"pt-6 md:pt-12 mb-4 md:mb-6"};ut.render=function(e,t,s,u,m,p){const h=a("SideNav"),b=a("XIcon"),g=a("MenuIcon"),f=a("ReloadPrompt");return o(),l("div",mt,[i("div",pt,[r(h)]),i("div",{class:c(["z-40 w-full min-h-full absolute bg-gray-50 md:hidden transition-all duration-300 ease-in-out print:hidden",u.open?"":"-ml-780"])},[i("button",{class:"absolute right-0 top-2 p-1 pr-3 bg-red-600 text-white text-xs uppercase",onClick:t[0]||(t[0]=C((e=>u.open=!1),["prevent"]))},[r(b,{class:"w-6 h-6"})]),u.open?n("",!0):(o(),l("button",{key:0,class:"fixed right-0 top-2 p-1 pr-3 bg-gray-900 text-white text-xs uppercase",onClick:t[1]||(t[1]=C((e=>u.open=!0),["prevent"]))},[r(g,{class:"w-6 h-6"})])),r(h)],2),i("div",ht,[i("div",{class:c([s.maxWidth,"m-auto px-4"])},[i("div",bt,[d(e.$slots,"header")]),d(e.$slots,"default")],2)]),r(f)])};const gt={props:{data:{type:Array,required:!0}}},ft=i("p",{class:"text-xs font-bold text-blue-600 mb-2"},"Tax Summary",-1),vt={class:"border border-gray-200 rounded-md overflow-x-auto"},xt={class:"table-fixed w-full"},yt=i("thead",{class:"text-left text-xs uppercase text-gray-600 border-b border-gray-200"},[i("tr",null,[i("th",{class:"w-1/5 px-2 py-1"},"Tax %"),i("th",{class:"w-1/5 px-2 py-1"},"Taxable"),i("th",{class:"w-1/5 px-2 py-1"},"CGST"),i("th",{class:"w-1/5 px-2 py-1"},"SGST"),i("th",{class:"w-1/5 px-2 py-1"},"Total")])],-1),wt={class:"px-2 py-1"},_t={class:"px-2 py-1"},It={class:"px-2 py-1"},kt={class:"px-2 py-1"},Ct={class:"px-2 py-1"},Ft={key:1},St=[i("td",{colspan:"5"},[i("div",{class:"mt-3 w-full bg-gray-100 rounded-md py-6 text-center text-sm text-gray-400"}," Not enough data to show report ")],-1)];gt.render=function(e,t,s,a,r,n){return o(),l("div",null,[ft,i("div",vt,[i("table",xt,[yt,i("tbody",null,[s.data.length?(o(!0),l(I,{key:0},k(s.data,((e,t)=>(o(),l("tr",{key:e.tax,class:c(t%2==0?"bg-gray-50":"")},[i("td",wt,u(parseInt(e.tax))+"%",1),i("td",_t,"₹"+u(parseFloat(e.taxable_total)),1),i("td",It,"₹"+u(parseFloat(e.cgst)),1),i("td",kt,"₹"+u(parseFloat(e.sgst)),1),i("td",Ct,"₹"+u(parseFloat(e.sum_total)),1)],2)))),128)):(o(),l("tr",Ft,St))])])])])};const $t={props:{data:{type:Array,required:!0}}},Pt=i("p",{class:"text-xs font-bold text-blue-600 mb-2"},"Most sold items",-1),Tt={class:"border border-gray-200 rounded-md overflow-x-auto"},Dt={class:"table-fixed w-full"},Vt=i("thead",{class:"text-left text-xs uppercase text-gray-600 border-b border-gray-200"},[i("tr",null,[i("th",{class:"w-1/12 px-2 py-1"},"#"),i("th",{class:"w-5/12 px-2 py-1"},"Name"),i("th",{class:"w-2/12 px-2 py-1"},"Tax%"),i("th",{class:"w-2/12 px-2 py-1"},"Sold"),i("th",{class:"w-2/12 px-2 py-1"},"Qty")])],-1),At={class:"px-2 py-1"},Mt={class:"px-2 py-1"},Et={class:"px-2 py-1"},Ut={class:"px-2 py-1"},Nt={class:"px-2 py-1"},qt={key:1},jt=[i("td",{colspan:"5"},[i("div",{class:"mt-3 w-full bg-gray-100 rounded-md py-6 text-center text-sm text-gray-400"}," Not enough data to show report ")],-1)];$t.render=function(e,t,s,a,r,n){return o(),l("div",null,[Pt,i("div",Tt,[i("table",Dt,[Vt,i("tbody",null,[s.data.length?(o(!0),l(I,{key:0},k(s.data,((e,t)=>(o(),l("tr",{key:e.name,class:c(t%2==0?"bg-gray-50":"")},[i("td",At,u(t+1),1),i("td",Mt,u(e.name),1),i("td",Et,u(parseFloat(e.tax_rate))+"%",1),i("td",Ut,"₹"+u(parseFloat(e.sold_total)),1),i("td",Nt,u(parseFloat(e.sold_count)),1)],2)))),128)):(o(),l("tr",qt,jt))])])])])};const Rt={props:{data:{type:Array,required:!0}}},Lt=i("p",{class:"text-xs font-bold text-blue-600 mb-2"},"Top customers",-1),Gt={class:"border border-gray-200 rounded-md overflow-x-auto"},Bt={class:"table-fixed w-full"},Yt=i("thead",{class:"text-left text-xs uppercase text-gray-600 border-b border-gray-200"},[i("tr",null,[i("th",{class:"w-1/12 px-2 py-1"},"#"),i("th",{class:"w-7/12 px-2 py-1"},"Customer name"),i("th",{class:"w-2/12 px-2 py-1"},"Sold"),i("th",{class:"w-2/12 px-2 py-1"},"Tax")])],-1),Ot={class:"px-2 py-1"},Zt={class:"px-2 py-1"},zt={key:0,class:"text-sm"},Wt=U("GSTIN: "),Xt={class:"text-blue-600 font-semibold"},Ht={key:1,class:"text-sm"},Qt=U("PAN: "),Kt={class:"text-blue-600 font-semibold"},Jt={class:"px-2 py-1"},es={class:"px-2 py-1"},ts={key:1},ss=[i("td",{colspan:"5"},[i("div",{class:"mt-3 w-full bg-gray-100 rounded-md py-6 text-center text-sm text-gray-400"}," Not enough data to show report ")],-1)];Rt.render=function(e,t,s,a,r,d){return o(),l(I,null,[Lt,i("div",Gt,[i("table",Bt,[Yt,i("tbody",null,[s.data.length?(o(!0),l(I,{key:0},k(s.data,((e,t)=>(o(),l("tr",{key:e.name,class:c(t%2==0?"bg-gray-50":"")},[i("td",Ot,u(t+1),1),i("td",Zt,[i("div",null,[i("p",null,u(e.customer_name),1),e.customer_gstin?(o(),l("p",zt,[Wt,i("span",Xt,u(e.customer_gstin),1)])):n("",!0),e.customer_pan?(o(),l("p",Ht,[Qt,i("span",Kt,u(e.customer_pan),1)])):n("",!0)])]),i("td",Jt,"₹"+u(parseFloat(e.sold_total)),1),i("td",es,"₹"+u(parseFloat(e.tax_total)),1)],2)))),128)):(o(),l("tr",ts,ss))])])])],64)};const as={props:{data:{type:Object,required:!0}}},os=i("div",{class:"py-2 font-bold text-blue-600 text-sm"}," Total number of invoices issued ",-1),ls={class:"rounded-md text-gray-600 bg-gray-50 border border-gray-200"},rs={class:"grid grid-cols-3 font-semibold text-sm text-center"},ns={class:"px-3 py-2 border-r border-gray-200"},is=i("p",null,"Retail:",-1),ds={class:"text-xl md:text-3xl font-bold"},cs={class:"px-3 py-2 border-r border-gray-200"},us=i("p",null,"B2B:",-1),ms={class:"text-xl md:text-3xl font-bold"},ps={class:"px-3 py-2"},hs=i("p",null,"Total:",-1),bs={class:"text-xl md:text-3xl font-bold"};as.render=function(e,t,s,a,r,n){return o(),l("div",null,[os,i("div",ls,[i("div",rs,[i("div",ns,[is,i("div",ds,u(s.data.retail),1)]),i("div",cs,[us,i("div",ms,u(s.data.b2b),1)]),i("div",ps,[hs,i("div",bs,u(s.data.total),1)])])])])};const gs={components:{AppLayout:ut,Datepicker:G,Spin:Pe,TaxSummary:gt,MostSold:$t,TopCustomers:Rt,InvoiceSummary:as},mounted(){this.getReports()},data:()=>({fromDate:B().subtract(1,"month").toDate(),toDate:B().toDate(),loading:!1,reports:null}),watch:{fromDate:function(e){this.getReports()},toDate:function(e){this.getReports()}},methods:{moment:B,getReports(){this.loading=!0;let t="/api/dashboard";this.fromDate&&!this.toDate&&(t+=`?filter[from_date]=${this.getFormattedDate(this.fromDate)}`),this.toDate&&!this.fromDate&&(t+=`?filter[to_date]=${this.getFormattedDate(this.toDate)}`),this.fromDate&&this.toDate&&(t+=`?filter[from_date]=${this.getFormattedDate(this.fromDate)}&filter[to_date]=${this.getFormattedDate(this.toDate)}`),e.get(t).then((e=>{this.loading=!1,this.reports=e.data.data})).catch((e=>{this.loading=!1,console.log(e.response)}))},getFormattedDate:e=>B(e).format("YYYY-MM-DD")}},fs={class:"flex flex-col md:flex-row justify-between md:items-center"},vs=i("h2",{class:"text-xl md:text-3xl font-bold leading-none"},"Dashboard",-1),xs={class:"md:w-1/3 flex items-center justify-between space-x-2"},ys={class:"w-full md:w-36"},ws=i("div",{class:"text-xs font-semibold text-gray-600"},"From date",-1),_s={class:"w-full md:w-36"},Is=i("div",{class:"text-xs font-semibold text-gray-600"},"To date",-1),ks={key:0,class:"pb-16 md:pb-32"},Cs={class:"mb-6"},Fs=U(" Showing reports from "),Ss={class:"font-bold rounded-md bg-blue-50 text-blue-600 px-2"},$s=U(" to "),Ps={class:"font-bold rounded-md bg-blue-50 text-blue-600 px-2"},Ts={class:"pt-6"},Ds={class:"pt-6"},Vs={class:"pt-6"};gs.render=function(e,t,s,d,c,m){const p=a("datepicker"),h=a("InvoiceSummary"),b=a("TaxSummary"),g=a("MostSold"),f=a("TopCustomers"),v=a("Spin"),x=a("AppLayout");return o(),Y(x,{"max-width":"max-w-3xl"},{header:_((()=>[i("div",fs,[vs,i("div",xs,[i("div",ys,[ws,r(p,{modelValue:c.fromDate,"onUpdate:modelValue":t[0]||(t[0]=e=>c.fromDate=e),"input-format":"dd-MM-yyyy"},null,8,["modelValue"])]),i("div",_s,[Is,r(p,{modelValue:c.toDate,"onUpdate:modelValue":t[1]||(t[1]=e=>c.toDate=e),"input-format":"dd-MM-yyyy"},null,8,["modelValue"])])])])])),default:_((()=>[r(v,{spinning:c.loading},{default:_((()=>[c.reports?(o(),l("div",ks,[i("div",Cs,[Fs,i("span",Ss,u(m.moment(this.fromDate).format("DD-MM-YYYY")),1),$s,i("span",Ps,u(m.moment(this.toDate).format("DD-MM-YYYY")),1)]),r(h,{data:c.reports.invoice_counts},null,8,["data"]),i("div",Ts,[r(b,{data:c.reports.tax_summary},null,8,["data"])]),i("div",Ds,[r(g,{data:c.reports.most_sold_items},null,8,["data"])]),i("div",Vs,[r(f,{data:c.reports.top_customers},null,8,["data"])])])):n("",!0)])),_:1},8,["spinning"])])),_:1})};const As=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,Ms=/^[A-Z]{4}0[A-Z0-9]{6}$/,Es=/^[6-9]\d{9}$/,Us=m({components:{Spin:Pe,UserIcon:p,LockClosedIcon:h,FormGroup:Ve},setup(){O((()=>{o()}));const t=b(),s=Z(),a=w({}),o=()=>{A.value=!0,e.get("/api/shop").then((e=>{a.value=e.data.data,A.value=!1}))},l=f({name:v().required(),address:v().required(),phone:z((()=>v().when(["phone"],{is:e=>(null==e?void 0:e.length)>0,then:v().matches(Es,"Must be a valid phone number")}).nullable())),alt_phone:z((()=>v().when(["alt_phone"],{is:e=>(null==e?void 0:e.length)>0,then:v().matches(Es,"Must be a valid phone number")}).nullable())),email:v().nullable().email(),gstin:z((()=>v().when(["gstin"],{is:e=>(null==e?void 0:e.length)>0,then:v().matches(As,"Must be a valid GSTIN number")}).nullable())),bank_name:v().nullable(),bank_branch:v().nullable(),bank_ifsc:z((()=>v().when(["bank_ifsc"],{is:e=>(null==e?void 0:e.length)>0,then:v().matches(Ms,"Must be a valid IFSC code")}).nullable())),bank_account:v().nullable()}),r=x({validationSchema:l,initialValues:a}),{value:n,errorMessage:i}=y("name"),{value:d,errorMessage:c}=y("address"),{value:u,errorMessage:m}=y("phone"),{value:p,errorMessage:h}=y("alt_phone"),{value:g,errorMessage:_}=y("email"),{value:I,errorMessage:k}=y("gstin"),{value:C,errorMessage:F}=y("bank_name"),{value:S,errorMessage:$}=y("bank_branch"),{value:P,errorMessage:T}=y("bank_ifsc"),{value:D,errorMessage:V}=y("bank_account"),A=w(!1),M=w(null);return{loading:A,errors:M,name:n,nameError:i,address:d,addressError:c,phone:u,phoneError:m,alt_phone:p,alt_phoneError:h,email:g,emailError:_,gstin:I,gstinError:k,bank_name:C,bank_nameError:F,bank_branch:S,bank_branchError:$,bank_ifsc:P,bank_ifscError:T,bank_account:D,bank_accountError:V,save:()=>{r.validate().then((({valid:a})=>{a&&(A.value=!0,M.value=null,e.patch("/api/shop",r.values).then((e=>{s.success(e.data.message),t.commit("user/SET_SHOP",e.data.data),o()})).catch((e=>{A.value=!1,422===e.response.status&&(M.value=e.response.data.errors)})))}))}}}}),Ns={class:"md:pb-32 pb-16"},qs={class:"grid md:grid-cols-2 grid-cols-1 md:gap-x-4 gap-y-2"},js=i("button",{class:"btn-primary mt-6",type:"submit"},"Save",-1);Us.render=function(e,t,s,n,d,u){const m=a("FormGroup"),p=a("spin");return o(),l("div",Ns,[r(p,{spinning:e.loading},{default:_((()=>[i("form",{onSubmit:t[10]||(t[10]=C(((...t)=>e.save&&e.save(...t)),["prevent"]))},[i("div",qs,[r(m,{label:"Name","label-for":"name",error:e.nameError,required:"",class:"md:col-span-2"},{default:_((()=>[F(i("input",{id:"name",name:"name","onUpdate:modelValue":t[0]||(t[0]=t=>e.name=t),required:"",class:c(["form-control",e.nameError?"form-control--error":""])},null,2),[[S,e.name]])])),_:1},8,["error"]),r(m,{label:"Address","label-for":"address",error:e.addressError,required:"",class:"md:col-span-2"},{default:_((()=>[F(i("textarea",{id:"address",name:"address","onUpdate:modelValue":t[1]||(t[1]=t=>e.address=t),required:"",class:c(["form-control",e.addressError?"form-control--error":""])},null,2),[[S,e.address]])])),_:1},8,["error"]),r(m,{label:"Phone","label-for":"phone",error:e.phoneError},{default:_((()=>[F(i("input",{id:"phone",name:"phone","onUpdate:modelValue":t[2]||(t[2]=t=>e.phone=t),class:c(["form-control",e.phoneError?"form-control--error":""])},null,2),[[S,e.phone]])])),_:1},8,["error"]),r(m,{label:"Alt Phone","label-for":"alt_phone",error:e.alt_phoneError},{default:_((()=>[F(i("input",{id:"alt_phone",name:"alt_phone","onUpdate:modelValue":t[3]||(t[3]=t=>e.alt_phone=t),class:c(["form-control",e.alt_phoneError?"form-control--error":""])},null,2),[[S,e.alt_phone]])])),_:1},8,["error"]),r(m,{label:"Email","label-for":"email",error:e.emailError},{default:_((()=>[F(i("input",{id:"email",name:"email","onUpdate:modelValue":t[4]||(t[4]=t=>e.email=t),class:c(["form-control",e.emailError?"form-control--error":""])},null,2),[[S,e.email]])])),_:1},8,["error"]),r(m,{label:"GSTIN","label-for":"gstin",error:e.gstinError},{default:_((()=>[F(i("input",{id:"gstin",name:"gstin","onUpdate:modelValue":t[5]||(t[5]=t=>e.gstin=t),class:c(["form-control",e.gstinError?"form-control--error":""])},null,2),[[S,e.gstin]])])),_:1},8,["error"]),r(m,{label:"Bank name","label-for":"bank_name",error:e.bank_nameError},{default:_((()=>[F(i("input",{id:"bank_name",name:"bank_name","onUpdate:modelValue":t[6]||(t[6]=t=>e.bank_name=t),class:c(["form-control",e.bank_nameError?"form-control--error":""])},null,2),[[S,e.bank_name]])])),_:1},8,["error"]),r(m,{label:"Bank branch","label-for":"bank_branch",error:e.bank_branchError},{default:_((()=>[F(i("input",{id:"bank_branch",name:"bank_branch","onUpdate:modelValue":t[7]||(t[7]=t=>e.bank_branch=t),class:c(["form-control",e.bank_branchError?"form-control--error":""])},null,2),[[S,e.bank_branch]])])),_:1},8,["error"]),r(m,{label:"Bank IFSC","label-for":"bank_ifsc",error:e.bank_ifscError},{default:_((()=>[F(i("input",{id:"bank_ifsc",name:"bank_ifsc","onUpdate:modelValue":t[8]||(t[8]=t=>e.bank_ifsc=t),class:c(["form-control",e.bank_ifscError?"form-control--error":""])},null,2),[[S,e.bank_ifsc]])])),_:1},8,["error"]),r(m,{label:"Bank account","label-for":"bank_account",error:e.bank_accountError},{default:_((()=>[F(i("input",{id:"bank_account",name:"bank_account","onUpdate:modelValue":t[9]||(t[9]=t=>e.bank_account=t),class:c(["form-control",e.bank_accountError?"form-control--error":""])},null,2),[[S,e.bank_account]])])),_:1},8,["error"])]),js],32)])),_:1},8,["spinning"])])};const Rs={components:{Spin:Pe},data:()=>({showBankDetails:!1,saveCustomers:!1,loading:!1}),mounted(){this.getSettings()},methods:{getSettings(){this.loading=!0,e.get("/api/settings").then((e=>{this.loading=!1,this.saveCustomers=e.data.data.save_customers,this.showBankDetails=e.data.data.show_bank_details})).catch((e=>{this.loading=!1,console.log(e.response)}))},handleChange(){this.loading=!0,e.patch("/api/settings",{save_customers:this.saveCustomers,show_bank_details:this.showBankDetails}).then((e=>{this.loading=!1,this.store.commit("user/SET_SETTINGS",e.data.data)})).catch((e=>{this.loading=!1,console.log(e)}))}},setup(){const e=b();return{toast:Z(),store:e}}},Ls={class:"w-full py-3 space-y-6"},Gs={class:"flex items-center"},Bs={class:"w-12"},Ys=i("div",{class:"flex-1"},[i("div",null,[i("p",{class:"text-lg font-bold"},"Show bank details in invoice"),i("p",{class:"text-sm"},"Uncheck the checkbox if you want to hide bank details in invoices.")])],-1),Os={class:"flex items-center"},Zs={class:"w-12"},zs=i("div",{class:"flex-1"},[i("div",null,[i("p",{class:"text-lg font-bold"},"Save customers on invoice creation"),i("p",{class:"text-sm"},"Check this if you want customer with unique GSTIN to be saved automatically during invoice creation")]),i("p",{class:"text-sm text-red-500"},"Customer won't be saved automatically if there is no GSTIN provided for the customer")],-1);Rs.render=function(e,t,s,l,r,n){const d=a("Spin");return o(),Y(d,{spinning:e.loading},{default:_((()=>[i("div",Ls,[i("div",Gs,[i("div",Bs,[F(i("input",{type:"checkbox",onChange:t[0]||(t[0]=(...e)=>n.handleChange&&n.handleChange(...e)),"onUpdate:modelValue":t[1]||(t[1]=t=>e.showBankDetails=t),id:"showBankDetails",class:"w-5 h-5"},null,544),[[W,e.showBankDetails]])]),Ys]),i("div",Os,[i("div",Zs,[F(i("input",{type:"checkbox",onChange:t[2]||(t[2]=(...e)=>n.handleChange&&n.handleChange(...e)),"onUpdate:modelValue":t[3]||(t[3]=t=>e.saveCustomers=t),id:"saveCustomers",class:"w-5 h-5"},null,544),[[W,e.saveCustomers]])]),zs])])])),_:1},8,["spinning"])};const Ws={components:{AppLayout:ut,BusinessSettings:Us,GeneralSettings:Rs},setup:()=>({currentTab:w("general")})},Xs=i("h2",{class:"text-xl md:text-3xl font-bold leading-none"},"Settings",-1),Hs={class:"flex space-x-8 items-center"},Qs=i("hr",{class:"mb-6 border-t border-gray-100",style:{"margin-top":"-1px"}},null,-1),Ks={key:0},Js={key:1};Ws.render=function(e,t,s,d,u,m){const p=a("GeneralSettings"),h=a("BusinessSettings"),b=a("AppLayout");return o(),Y(b,{"max-width":"max-w-xl"},{header:_((()=>[Xs])),default:_((()=>[i("div",null,[i("div",Hs,[i("button",{onClick:t[0]||(t[0]=C((e=>d.currentTab="general"),["prevent"])),class:c(["font-semibold py-2 border-b border-gray-100","general"===d.currentTab?"text-blue-500 border-b border-blue-500":""])},"General",2),i("button",{onClick:t[1]||(t[1]=C((e=>d.currentTab="business"),["prevent"])),class:c(["font-semibold py-2 border-b border-gray-100","business"===d.currentTab?"text-blue-500 border-b border-blue-500":""])},"Business",2)]),Qs,"general"===d.currentTab?(o(),l("div",Ks,[r(p)])):n("",!0),"business"===d.currentTab?(o(),l("div",Js,[r(h)])):n("",!0)])])),_:1})};const ea={components:{CalendarIcon:X,XIcon:R},props:{invoice:{type:Object,required:!0}},methods:{moment:B}},ta={href:"javascript:void;",class:"group"},sa={class:"md:-mx-4 bg-white group-hover:bg-blue-50 border border-white group-hover:border rounded-md group-hover:border-blue-500 transition-all ease-in-out duration-200"},aa={class:"w-full flex flex-col md:flex-row"},oa={class:"md:px-4 py-2 md:w-3/12 hover:border-r group-hover:border-blue-500"},la={class:"text-lg text-gray-500 font-bold"},ra={class:"flex items-center leading-none text-sm text-gray-400 font-bold mt-1"},na={class:"md:w-9/12 flex justify-between"},ia={class:"md:px-4 py-2 hover:border-r group-hover:border-blue-500 leading-none"},da={key:0},ca=[i("p",{class:"text-lg font-semibold"},"Retail Customer",-1)],ua={key:1},ma={class:"text-lg font-semibold"},pa={class:"text-xs font-bold text-gray-500 mt-1"},ha=U("GSTIN: "),ba={class:"text-gray-500"},ga={class:"md:px-4 py-2 md:w-1/3"},fa=i("p",{class:"text-xs font-bold text-gray-500"},"Invoice total",-1),va={class:"font-bold text-lg text-gray-500"};ea.render=function(e,t,s,n,d,c){var m;const p=a("CalendarIcon");return o(),l("a",ta,[i("div",sa,[i("div",aa,[i("div",oa,[i("h3",la,"# "+u(s.invoice.invoice_no),1),i("div",ra,[r(p,{class:"w-4 h-4 mr-1"}),i("span",null,u(c.moment(s.invoice.invoice_date).format("DD-MM-YYYY")),1)])]),i("div",na,[i("div",ia,[s.invoice.retail?(o(),l("div",da,ca)):(o(),l("div",ua,[i("p",ma,u(s.invoice.customer_name),1),i("p",pa,[ha,i("span",ba,u(null!=(m=s.invoice.customer_gstin)?m:"----"),1)])]))]),i("div",ga,[fa,i("div",va," ₹ "+u(s.invoice.total),1)])])])])])};const xa={components:{CalendarIcon:X,XIcon:R},props:{show:{type:Boolean,default:!1}},emits:["confirm","close"],methods:{moment:B,confirm(){this.$emit("confirm",!0)},close(){this.$emit("close")}}},ya={class:"max-w-6xl mx-auto print:max-w-100 px-4 md:px-0"},wa={class:"flex justify-between items-center mt-8 border-b border-gray-200 print:hidden"},_a={class:"text-lg font-bold text-gray-600 py-2"},Ia={class:"py-8"};xa.render=function(e,t,s,n,u,m){const p=a("XIcon");return o(),l("div",null,[i("div",{class:c(["fixed inset-0 md:ml-52 print:m-2 min-h-full overflow-y-auto print:overflow-y-hidden bg-white border-t-4 border-blue-500 transition-all ease-in-out duration-300 print:border-t-0",s.show?"":"-mt-10xl"])},[i("div",ya,[i("div",wa,[i("div",_a,[d(e.$slots,"header")]),i("button",{class:"p-2 bg-red-50 hover:bg-red-100 text-red-600 transition-all ease-in-out duration-200",onClick:t[0]||(t[0]=(...e)=>m.close&&m.close(...e))},[r(p,{class:"w-6 h-6"})])]),i("div",Ia,[d(e.$slots,"default")])])],2)])};const ka={emits:["close"],props:{invoice:{type:Object,required:!0,default:null},isPrint:{type:Boolean,default:!1}},components:{Spin:Pe,PhoneIcon:H,MailIcon:Q,CalendarIcon:X},data:()=>({loading:!1}),methods:{print(){this.$router.push({name:"invoices.print",params:{invoiceId:this.invoice.id}})},edit(){this.$router.push({name:"invoices.edit",params:{invoiceId:this.invoice.id}})},destroy(){window.confirm("Are you sure you want to delete this invoice?")&&(this.loading=!0,e.delete(`/api/invoices/${this.invoice.id}`).then((e=>{this.loading=!1,this.$emit("deleted")})).catch((e=>{this.loading=!1,console.log(e.response)})))}},setup(){const e=b(),t=e.getters["user/shop"],s=e.getters["user/settings"];return{moment:B,numWords:K,shop:t,settings:s}}},Ca={key:0,id:"invoiceDetails"},Fa={key:0,class:"mb-4 print:hidden flex justify-between items-center"},Sa={class:"flex items-center space-x-2"},$a={class:"overflow-x-auto"},Pa={class:"min-w-54 print:min-w-full"},Ta={class:"flex justify-between border border-gray-200 border-b-0"},Da={class:"w-2/3 px-4 py-3 border-r border-gray-200"},Va={class:"text-xl font-bold"},Aa={class:"text-sm font-bold text-gray-500 uppercase tracking-wide"},Ma={class:"flex items-center mt-2"},Ea={key:0},Ua={class:"flex items-center mt-1"},Na={class:"w-1/3 px-4 py-3 leading-none"},qa=i("p",{class:"text-sm font-semibold text-gray-700"},"Invoice no",-1),ja={class:"font-bold text-lg mt-1"},Ra=i("p",{class:"text-sm font-semibold text-gray-700 mt-2"},"Invoice date",-1),La={class:"flex items-center text-sm font-bold text-gray-500 mt-1"},Ga={class:"flex justify-between border border-gray-200 border-b-0"},Ba={class:"w-2/3 px-4 py-3 border-r border-gray-200"},Ya=i("p",{class:"text-sm font-semibold text-gray-700"},"Issued to",-1),Oa={key:0},Za=[i("p",{class:"text-lg font-bold"},"Retail Customer",-1)],za={key:1},Wa={class:"text-lg font-bold"},Xa={key:0,class:"text-sm font-bold text-gray-500 tracking-wide uppercase"},Ha={key:1,class:"text-sm font-bold text-gray-500 tracking-wide uppercase"},Qa={class:"w-1/3 px-4 py-3"},Ka=i("p",{class:"text-sm font-semibold text-gray-700"},"State sold to",-1),Ja=i("div",{class:"text-xs font-bold text-gray-600 px-4 py-2 border border-gray-200 uppercase tracking-wider"},"Invoice items",-1),eo={class:"table-fixed w-full border border-gray-200 border-t-0"},to=i("thead",null,[i("tr",{class:"text-left text-sm bg-gray-100"},[i("th",{class:"w-10 p-1 px-4 border-r border-b border-gray-200"},"#"),i("th",{class:"w-3/12 p-1 border-r border-b border-gray-200"},"Item Name"),i("th",{class:"w-auto p-1 border-r border-b border-gray-200"},"Quantity"),i("th",{class:"w-auto p-1 border-r border-b border-gray-200"},"Unit price"),i("th",{class:"w-auto p-1 border-r border-b border-gray-200"},"Taxable"),i("th",{class:"w-auto p-1 border-r border-b border-gray-200"},"Tax %"),i("th",{class:"w-auto p-1 border-r border-b border-gray-200"},"Tax"),i("th",{class:"w-2/12 border-b border-gray-200 p-1 px-4"},"Total")])],-1),so={class:"p-1 px-4 border-r border-b border-gray-200"},ao={class:"p-1 px-4 border-r border-b border-gray-200"},oo={class:"p-1 border-r border-b border-gray-200"},lo={class:"p-1 border-r border-b border-gray-200"},ro={class:"p-1 border-r border-b border-gray-200"},no={class:"p-1 border-r border-b border-gray-200"},io={class:"p-1 border-r border-b border-gray-200"},co={class:"p-1 px-4 border-b border-gray-200"},uo={class:"border-t border-gray-200 bg-blue-100"},mo=i("td",{colspan:"7",class:"p-1 text-right border-r border-gray-200 pr-4 font-bold"},"Total amount",-1),po={colspan:"1",class:"p-1 pl-4 font-bold"},ho={class:"flex justify-between"},bo={class:"w-7/12 border-b border-l border-gray-200"},go={class:"px-4 py-2"},fo=i("p",{class:"text-sm text-gray-500 font-semibold mb-1"},"Additional tax info",-1),vo={class:"table-fixed w-full"},xo=i("thead",null,[i("tr",{class:"text-left"},[i("th",{class:"w-1/6"},"Rate"),i("th",{class:"w-1/6"},"Taxable"),i("th",{class:"w-1/6"},"Tax"),i("th",{class:"w-1/6"},"CGST"),i("th",{class:"w-1/6"},"SGST"),i("th",{class:"w-1/6"},"Total")])],-1),yo={key:0,class:"px-4 py-2 border-t border-gray-200"},wo=i("p",{class:"text-sm text-gray-500 font-semibold mb-1"},"Bank details",-1),_o={class:"table-fixed w-full"},Io=i("td",{class:"w-24 text-sm"},"Name:",-1),ko={class:"font-bold"},Co=i("td",{class:"w-24 text-sm"},"Branch:",-1),Fo={class:"font-bold"},So=i("td",{class:"w-24 text-sm"},"IFSC:",-1),$o={class:"font-bold"},Po=i("td",{class:"w-24 text-sm"},"Account:",-1),To={class:"font-bold"},Do={class:"w-5/12 border border-gray-200 border-t-0"},Vo=i("p",{class:"text-sm text-gray-500 font-semibold mb-1 px-4 pt-3"},"Total",-1),Ao={class:"table-fixed w-full"},Mo=i("td",{class:"px-4 border-b border-t border-gray-200"},"Taxable",-1),Eo={class:"px-4 border-b border-t border-gray-200"},Uo=i("td",{class:"px-4 border-b border-gray-200"},"CGST",-1),No={class:"px-4 border-b border-gray-200"},qo=i("td",{class:"px-4 border-b border-gray-200"},"SGST",-1),jo={class:"px-4 border-b border-gray-200"},Ro=i("td",{class:"px-4 border-b border-gray-200"},"Discount",-1),Lo={class:"px-4 border-b border-gray-200"},Go=i("td",{class:"px-4 border-b border-gray-200 font-bold"},"Total payable",-1),Bo={class:"px-4 border-b border-gray-200 font-bold text-lg"},Yo={class:"px-4 pt-3"},Oo=i("p",{class:"text-sm text-gray-500 font-semibold mb-1"},"Total in words",-1),Zo={class:"font-bold capitalize"},zo={class:"flex justify-end border border-gray-200 border-t-0 px-4 py-3"},Wo={class:"w-full flex justify-between items-end"},Xo=U("Invoice issued by "),Ho={class:"font-bold"},Qo=i("div",{class:"mr-16"},[i("p",{class:"py-10"}),i("p",{class:"px-4 pt-1 border-t border-gray-200"},"Authorized signatory")],-1);ka.render=function(e,t,s,d,m,p){const h=a("PhoneIcon"),b=a("MailIcon"),g=a("CalendarIcon"),f=a("Spin");return o(),Y(f,{spinning:m.loading},{default:_((()=>{var e;return[s.invoice?(o(),l("div",Ca,[s.isPrint?n("",!0):(o(),l("div",Fa,[i("div",Sa,[i("button",{class:"btn-danger-sm",onClick:t[0]||(t[0]=(...e)=>p.destroy&&p.destroy(...e))},"Delete"),i("button",{class:"btn-secondary-sm",onClick:t[1]||(t[1]=(...e)=>p.edit&&p.edit(...e))},"Edit Invoice")]),i("div",null,[i("button",{class:"btn-primary-sm",onClick:t[2]||(t[2]=(...e)=>p.print&&p.print(...e))},"Print")])])),i("div",$a,[i("div",Pa,[i("div",Ta,[i("div",Da,[i("h1",Va,u(d.shop.name),1),i("p",Aa,u(d.shop.gstin),1),i("p",null,u(d.shop.address),1),i("p",null,u(d.shop.state.name),1),i("div",Ma,[r(h,{class:"w-4 h-4 mr-2"}),U(" "+u(d.shop.phone)+" ",1),d.shop.alt_phone?(o(),l("span",Ea,"| "+u(d.shop.alt_phone),1)):n("",!0)]),i("div",Ua,[r(b,{class:"w-4 h-4 mr-2"}),U(" "+u(d.shop.email),1)])]),i("div",Na,[qa,i("p",ja,u(s.invoice.invoice_no),1),Ra,i("div",La,[r(g,{class:"w-4 h-4 mr-2"}),U(" "+u(d.moment(s.invoice.invoice_date).format("DD-MM-YYYY")),1)])])]),i("div",Ga,[i("div",Ba,[Ya,s.invoice.retail?(o(),l("div",Oa,Za)):(o(),l("div",za,[i("p",Wa,u(s.invoice.customer_name),1),i("p",null,u(s.invoice.customer_address),1),s.invoice.customer_gstin?(o(),l("p",Xa,"GSTIN: "+u(s.invoice.customer_gstin),1)):n("",!0),s.invoice.customer_pan?(o(),l("p",Ha,"PAN: "+u(s.invoice.customer_pan),1)):n("",!0)]))]),i("div",Qa,[Ka,i("p",null,u(s.invoice.state.name),1)])]),i("div",null,[Ja,i("table",eo,[to,i("tbody",null,[(o(!0),l(I,null,k(s.invoice.items,((e,t)=>(o(),l("tr",{key:e.id,class:c(t%2!=0?"bg-gray-100":"")},[i("td",so,u(t+1),1),i("td",ao,u(e.name),1),i("td",oo,u(e.quantity),1),i("td",lo,"₹"+u(e.unit_price),1),i("td",ro,"₹"+u(e.taxable_amount),1),i("td",no,u(e.tax),1),i("td",io,"₹"+u(e.tax_amount),1),i("td",co,"₹"+u(e.total),1)],2)))),128)),i("tr",uo,[mo,i("td",po,"₹"+u(s.invoice.total+s.invoice.discount),1)])])])]),i("div",ho,[i("div",bo,[i("div",go,[fo,i("table",vo,[xo,i("tbody",null,[(o(!0),l(I,null,k(s.invoice.additional_tax_info,(e=>(o(),l("tr",{key:e.tax},[i("td",null,u(parseFloat(e.tax))+"%",1),i("td",null,u(e.taxable_total),1),i("td",null,u(e.tax_total),1),i("td",null,u((e.tax_total/2).toFixed(2)),1),i("td",null,u((e.tax_total/2).toFixed(2)),1),i("td",null,u(e.total_sum),1)])))),128))])])]),d.settings.show_bank_details?(o(),l("div",yo,[wo,i("table",_o,[i("tbody",null,[i("tr",null,[Io,i("td",ko,u(d.shop.bank_name),1)]),i("tr",null,[Co,i("td",Fo,u(d.shop.bank_branch),1)]),i("tr",null,[So,i("td",$o,u(d.shop.bank_ifsc),1)]),i("tr",null,[Po,i("td",To,u(d.shop.bank_account),1)])])])])):n("",!0)]),i("div",Do,[Vo,i("table",Ao,[i("tbody",null,[i("tr",null,[Mo,i("td",Eo,"₹"+u(s.invoice.taxable),1)]),i("tr",null,[Uo,i("td",No,"₹"+u(s.invoice.cgst),1)]),i("tr",null,[qo,i("td",jo,"₹"+u(s.invoice.sgst),1)]),i("tr",null,[Ro,i("td",Lo,"₹"+u(null!=(e=s.invoice.discount)?e:0),1)]),i("tr",null,[Go,i("td",Bo,"₹"+u(s.invoice.total),1)])])]),i("div",Yo,[Oo,i("p",Zo,"Rupees: "+u(d.numWords(s.invoice.total))+" Only",1)])])]),i("div",zo,[i("div",Wo,[i("div",null,[i("p",null,[Xo,i("span",Ho,u(d.shop.name),1)])]),Qo])])])])])):n("",!0)]})),_:1},8,["spinning"])};const Ko={props:{meta:Object,currentPage:Number},components:{ArrowNarrowLeftIcon:J,ArrowNarrowRightIcon:ee},emits:["change"],methods:{changePage(e){this.$emit("change",e)}}},Jo={class:"flex items-center justify-between my-8"},el={class:"w-1/3 text-sm text-gray-500"},tl={class:"text-xs"},sl={class:"flex-1 flex items-center justify-end"},al=["disabled"],ol=["onClick"],ll=["disabled"];Ko.render=function(e,t,s,n,d,m){const p=a("ArrowNarrowLeftIcon"),h=a("ArrowNarrowRightIcon");return o(),l("div",Jo,[i("div",el,[i("p",null,"Showing "+u(s.meta.from)+" to "+u(s.meta.to)+" of "+u(s.meta.total)+" items.",1),i("p",tl,u(s.meta.per_page)+" items per page.",1)]),i("div",sl,[i("button",{class:c(["py-2 px-3 text-sm font-semibold leading-none rounded-md hover:bg-gray-100 text-gray-500 transition-all ease-in-out duration-200",s.currentPage-1==0?"cursor-not-allowed opacity-50":""]),disabled:s.currentPage-1==0,onClick:t[0]||(t[0]=C((e=>m.changePage(s.currentPage-1)),["prevent"]))},[r(p,{class:"w-5 h-5"})],10,al),(o(!0),l(I,null,k(s.meta.last_page,(e=>(o(),l("div",{key:e.label},[i("button",{class:c(["py-2 px-3 text-sm font-semibold leading-none rounded-md transition-all ease-in-out duration-200",e===s.meta.current_page?"bg-gray-700 text-white":"text-gray-500 hover:bg-gray-100"]),onClick:C((t=>m.changePage(e)),["prevent"])},u(e),11,ol)])))),128)),i("button",{class:c(["py-2 px-3 text-sm font-semibold leading-none rounded-md hover:bg-gray-100 text-gray-500 transition-all ease-in-out duration-200",s.currentPage+1>s.meta.last_page?"cursor-not-allowed opacity-50":""]),disabled:s.currentPage+1>s.meta.last_page,onClick:t[1]||(t[1]=C((e=>m.changePage(s.currentPage+1)),["prevent"]))},[r(h,{class:"w-5 h-5"})],10,ll)])])};const rl={props:["createdInvoiceId"],components:{AppLayout:ut,InvoiceCard:ea,InvoiceSlide:xa,Spin:Pe,InvoiceDetails:ka,Pagination:Ko,Datepicker:G},mounted(){this.$route.query.page&&(this.currentPage=parseInt(this.$route.query.page)),this.getInvoices(),this.createdInvoiceId&&(this.loading=!0,e.get(`/api/invoices/${this.createdInvoiceId}`).then((e=>{this.loading=!1,this.selectedInvoice=e.data.data,this.showInvoice=!0})))},data:()=>({fromDate:B().subtract(1,"month").toDate(),toDate:B().toDate(),search:"",customerType:"all",loading:!1,selectedInvoice:null,showInvoice:!1,invoices:[],meta:{},currentPage:1}),watch:{fromDate:function(e){this.getInvoices()},toDate:function(e){this.getInvoices()},search:function(e){this.getInvoices()},customerType:function(e){this.getInvoices()}},methods:{changePage(e){this.currentPage=e,this.getInvoices(),this.$router.push({query:{page:e}})},updateSearch(e){this.search=e},getInvoices(){this.loading=!0;const t=B(this.fromDate).format("YYYY-MM-DD"),s=B(this.toDate).format("YYYY-MM-DD");let a=`/api/invoices?page=${this.currentPage}`;this.search?a+=`&filter[search]=${this.search}`:a+=`&filter[from_date]=${t}&filter[to_date]=${s}`,this.customerType&&(a+=`&filter[customer_type]=${this.customerType}`),e.get(a).then((e=>{this.loading=!1,this.invoices=e.data.data,this.meta=e.data.meta,this.currentPage>1&&!this.invoices.length&&this.changePage(1)})).catch((e=>{console.log(e)}))},selectInvoice(e){this.showInvoice=!0,this.selectedInvoice=e},closeInvoiceDetails(){this.showInvoice=!1,setTimeout((()=>{this.selectedInvoice=null}),300)},handleInvoiceDeleted(){this.showInvoice=!1,this.selectedInvoice=null,this.getInvoices()}}},nl={class:"flex flex-col justify-between"},il=i("h2",{class:"text-xl md:text-3xl font-bold leading-none mb-2"},"Invoices",-1),dl={class:"flex flex-col md:flex-row md:items-center justify-between space-x-2"},cl={class:"flex-1"},ul=i("div",{class:"text-xs font-semibold text-gray-600"},"Search invoices",-1),ml={class:"p-2 rounded-md bg-gray-50 w-full",type:"text",placeholder:"Invoice no / customer name"},pl={class:"flex items-center space-x-4"},hl={class:"md:w-36"},bl=i("div",{class:"text-xs font-semibold text-gray-600"},"From date",-1),gl={class:"md:w-36"},fl=i("div",{class:"text-xs font-semibold text-gray-600"},"To date",-1),vl={class:"md:w-36"},xl=i("div",{class:"text-xs font-semibold text-gray-600"},"Customer type",-1),yl=[i("option",{value:"all"},"All",-1),i("option",{value:"retail"},"Retail",-1),i("option",{value:"b2b"},"B2B",-1)],wl={key:0},_l=i("hr",{class:"bg-gray-100"},null,-1),Il={key:1,class:"bg-gray-50 rounded-md"},kl=[i("div",{class:"flex items-center justify-center w-full h-full py-32"},[i("p",{class:"text-gray-400"},"No Invoices found")],-1)],Cl=i("p",{class:"text-xs font-bold text-blue-500"},"Invoice details for",-1),Fl={class:"text-xl font-bold"},Sl={key:0};rl.render=function(e,t,s,d,c,m){const p=a("datepicker"),h=a("InvoiceCard"),b=a("Pagination"),g=a("InvoiceDetails"),f=a("InvoiceSlide"),v=a("Spin"),x=a("AppLayout"),y=te("debounce");return o(),Y(x,null,{header:_((()=>[i("div",nl,[il,i("div",dl,[i("div",cl,[ul,F(i("input",ml,null,512),[[y,m.updateSearch,"350ms"]])]),i("div",pl,[i("div",hl,[bl,r(p,{modelValue:c.fromDate,"onUpdate:modelValue":t[0]||(t[0]=e=>c.fromDate=e),"input-format":"dd-MM-yyyy"},null,8,["modelValue"])]),i("div",gl,[fl,r(p,{modelValue:c.toDate,"onUpdate:modelValue":t[1]||(t[1]=e=>c.toDate=e),"input-format":"dd-MM-yyyy"},null,8,["modelValue"])])]),i("div",vl,[xl,F(i("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>c.customerType=e),class:"form-control w-full"},yl,512),[[se,c.customerType]])])])])])),default:_((()=>[r(v,{spinning:c.loading},{default:_((()=>[c.invoices.length?(o(),l("div",wl,[(o(!0),l(I,null,k(c.invoices,(e=>(o(),l("div",{key:e.id},[r(h,{invoice:e,onClick:C((t=>m.selectInvoice(e)),["prevent"])},null,8,["invoice","onClick"]),_l])))),128)),r(b,{currentPage:c.currentPage,meta:c.meta,onChange:m.changePage},null,8,["currentPage","meta","onChange"])])):(o(),l("div",Il,kl)),r(f,{show:c.showInvoice,onClose:m.closeInvoiceDetails},ae({default:_((()=>[c.selectedInvoice?(o(),l("div",Sl,[r(g,{invoice:c.selectedInvoice,onDeleted:m.handleInvoiceDeleted},null,8,["invoice","onDeleted"])])):n("",!0)])),_:2},[c.selectedInvoice?{name:"header",fn:_((()=>[Cl,i("p",Fl,"# "+u(c.selectedInvoice.invoice_no),1)]))}:void 0]),1032,["show","onClose"])])),_:1},8,["spinning"])])),_:1})};const $l={components:{ArrowNarrowLeftIcon:J,XIcon:R,ReloadPrompt:ct},props:{headerText:{type:String,default:"Home"},maxWidth:{type:String,default:"max-w-4xl"}},setup(){const e=g();return{goBack:()=>{e.back()}}}},Pl={class:"relative flex min-h-screen text-gray-700"},Tl={class:"z-10 w-full bg-white"},Dl={class:"pt-6 md:pt-12 mb-4 md:mb-6"},Vl=i("span",null,"Go Back",-1),Al={class:"text-xl md:text-3xl font-bold leading-none"};$l.render=function(e,t,s,n,m,p){const h=a("ArrowNarrowLeftIcon"),b=a("ReloadPrompt");return o(),l("div",Pl,[i("div",Tl,[i("div",{class:c([s.maxWidth,"m-auto px-4"])},[i("div",Dl,[i("button",{onClick:t[0]||(t[0]=(...e)=>n.goBack&&n.goBack(...e)),class:"flex items-center font-bold text-sm text-blue-500 mb-6 hover:bg-gray-100 -ml-3 px-3 py-1 rounded"},[r(h,{class:"h-4 w-4 mr-2"}),Vl]),i("h2",Al,u(s.headerText),1)]),d(e.$slots,"default")],2)]),r(b)])};const Ml={components:{XCircleIcon:oe},inheritAttrs:!0,emits:["cancel","confirm"]},El={class:"mr-8 text-2xl font-bold"},Ul={class:"flex-grow overflow-y-auto py-4"},Nl=["onClick"];Ml.render=function(e,t,s,l,n,c){const u=a("XCircleIcon"),m=a("vue-final-modal");return o(),Y(m,le(e.$attrs,{"esc-to-close":!0,classes:"m-auto max-w-2xl mt-16","content-class":"relative flex flex-col max-h-full mx-4 p-4 border dark:border-gray-800 rounded bg-white dark:bg-gray-900"}),{default:_((({params:t,close:s})=>[i("span",El,[d(e.$slots,"title")]),i("div",Ul,[d(e.$slots,"default",{params:t})]),i("button",{class:"absolute top-0 right-0 mt-2 mr-2",onClick:s},[r(u,{class:"w-8 h-8 text-red-500"})],8,Nl)])),_:3},16)};const ql={props:{customer:{required:!0,type:Object}}},jl={class:"font-bold text-base capitalize group-hover:text-blue-600"},Rl={class:"uppercase text-xs font-semibold text-gray-500"},Ll=U(" GSTIN: "),Gl={class:"font-semibold group-hover:text-blue-600"},Bl={class:"uppercase text-xs font-semibold text-gray-500"},Yl=U(" PAN: "),Ol={class:"font-semibold group-hover:text-blue-600"},Zl={class:"mt-1"},zl=U(" Address: "),Wl={class:"font-semibold group-hover:text-blue-600"},Xl=U(" State: "),Hl={class:"font-semibold group-hover:text-blue-600"};ql.render=function(e,t,s,a,r,n){return o(),l("div",null,[i("div",jl,u(s.customer.name),1),i("div",Rl,[Ll,i("span",Gl,u(s.customer.gstin),1)]),i("div",Bl,[Yl,i("span",Ol,u(s.customer.pan),1)]),i("div",Zl,[zl,i("span",Wl,u(s.customer.address),1)]),i("div",null,[Xl,i("span",Hl,u(s.customer.state.name),1)])])};const Ql={props:{product:{type:Object,required:!0}}},Kl={class:"font-bold capitalize group-hover:text-blue-600"},Jl={class:"uppercase text-xs font-bold text-gray-500"},er=U(" Unit price: "),tr={class:"font-bold group-hover:text-blue-600"},sr=U(" Tax: "),ar={class:"group-hover:text-blue-600"};Ql.render=function(e,t,s,a,r,n){return o(),l("div",null,[i("div",Kl,u(s.product.name),1),i("div",Jl,"Code: "+u(s.product.code),1),i("div",null,[er,i("span",tr,"₹"+u(s.product.unit_price),1)]),i("div",null,[sr,i("span",ar,u(s.product.tax)+"%",1)])])};const or=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,lr=/^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}?$/,rr={props:{editInvoice:{default:null}},components:{FormGroup:Ve,Field:re,Form:ne,ErrorMessage:ie,CogIcon:de,XCircleIcon:oe,PlusIcon:P,DuplicateIcon:ce,Datepicker:G,Spin:Pe,Modal:Ml,CustomerSelectCard:ql,ProductSelectCard:Ql},mounted(){this._keyListener=function(e){"n"===e.key&&(e.altKey||e.metaKey)&&(e.preventDefault(),this.add())},document.addEventListener("keydown",this._keyListener.bind(this)),this.getInitialData()},beforeDestroy(){document.removeEventListener("keydown",this._keyListener)},watch:{search:function(e){this.getProducts()},searchCustomer:function(e){this.getCustomers()}},data:()=>({loading:!1,search:"",products:[],showProductModal:!1,searchCustomer:"",customers:[],showCustomerModal:!1,selectedIndex:null,createdInvoice:null,formValues:null,schema:f().shape({invoice_no:v().required(),retail:ue().label("Retail Customer"),customer_name:z((()=>v().when(["retail"],{is:e=>1!=e,then:v().required().label("Customer Name").typeError("Customer name is required"),otherwise:v().nullable().label("Customer Name")}).nullable())),customer_address:v().nullable().label("Customer Address"),state_id:v().required().label("Customer State"),customer_gstin:z((()=>v().when(["gstin"],{is:e=>(null==e?void 0:e.length)>0,then:v().matches(or,"Must be a valid GSTIN number")}).nullable())),discount:v().label("Discount"),customer_pan:z((()=>v().when(["pan"],{is:e=>(null==e?void 0:e.length)>0,then:v().matches(lr,"Must be a valid PAN number")}).nullable())),items:me().of(f().shape({name:v().required().label("Name"),quantity:v().required().label("Quantity"),unit_price:v().required().label("unit price"),tax:v().label("Tax %"),tax_amount:v().label("Tax amount"),taxable_amount:v().label("Taxable amount"),inclusive:ue().label("Inclusive"),total:v().label("Total")})).strict()}),states:[],date:null,toDate:B().endOf("month").toDate(),fromDate:B().startOf("year").toDate(),invoiceCount:"",total:0,totalTaxable:0,totalTax:0,items:[]}),methods:{openProductSelect(e,t){this.selectedIndex=t,this.formValues=e,this.showProductModal=!0,this.getProducts()},openCustomerSelect(){this.showCustomerModal=!0,this.getCustomers()},updateSearch(e){this.search=e},updateCustomerSearch(e){this.searchCustomer=e},getProducts(){const t=this.search?`&filter[search]=${this.search}`:"";e.get("/api/products?limit=12"+t).then((e=>{this.products=e.data.data})).catch((e=>{console.log(e.response)}))},getCustomers(){const t=this.searchCustomer?`&filter[search]=${this.searchCustomer}`:"";e.get("/api/customers?limit=12"+t).then((e=>{this.customers=e.data.data})).catch((e=>{console.log(e.response)}))},handleModalClose(){this.showProductModal=!1},handleCustomerModalClose(){this.showCustomerModal=!1},handleProductSelect(e){this.$refs.invoiceForm.setFieldValue(`items[${this.selectedIndex}].name`,e.name.toString()),this.$refs.invoiceForm.setFieldValue(`items[${this.selectedIndex}].unit_price`,e.unit_price.toString()),this.$refs.invoiceForm.setFieldValue(`items[${this.selectedIndex}].tax`,e.tax.toString()),this.$refs.invoiceForm.setFieldValue(`items[${this.selectedIndex}].inclusive`,e.inclusive),this.$nextTick((()=>{this.handleModalClose(),this.setTotal(this.formValues,this.selectedIndex)}))},handleCustomerSelect(e){this.$refs.invoiceForm.setFieldValue("customer_name",e.name.toString()),this.$refs.invoiceForm.setFieldValue("customer_address",e.address?e.address.toString():null),this.$refs.invoiceForm.setFieldValue("customer_gstin",e.gstin?e.gstin.toString():null),this.$refs.invoiceForm.setFieldValue("customer_pan",e.pan?e.pan.toString():null),this.$refs.invoiceForm.setFieldValue("state_id",e.state_id.toString()),this.$nextTick((()=>{this.handleCustomerModalClose()}))},getInitialData(){this.loading=!0,e.get("/api/states").then((({data:t})=>{this.states=t.data,this.$refs.invoiceForm.setFieldValue("state_id",14),e.get("/api/invoice-count").then((({data:e})=>{this.loading=!1;const t=e.count+1;this.$refs.invoiceForm.setFieldValue("invoice_no",B().format("yyyy/MM")+`-${t.toString().padStart(4,0)}`),this.$refs.invoiceForm.setFieldValue("state_id",14),this.editInvoice?(this.items=this.editInvoice.items,this.date=new Date(this.editInvoice.invoice_date),this.setInvoiceData()):(this.items.push({id:Date.now()}),this.date=new Date,this.$refs.invoiceForm.setFieldValue("retail",1))})).catch((e=>{this.loading=!1,console.log(e)}))})).catch((e=>{this.loading=!1,console.log(e)}))},onSubmit(t){this.loading=!0,t.invoice_date=B(this.date).format("YYYY-MM-DD"),this.totalTaxable>t.discount?this.editInvoice?e.patch(`/api/invoices/${this.editInvoice.id}`,t).then((e=>{this.loading=!1,this.createdInvoice=e.data.data,this.toast.success("Invoice updated successfully!"),this.$router.push({name:"invoices.list",params:{createdInvoiceId:this.createdInvoice.id}})})).catch((e=>{this.loading=!1,console.log(e.response.data.errors)})):e.post("/api/invoices",t).then((e=>{this.loading=!1,this.createdInvoice=e.data.data,this.toast.success("Invoice created successfully!"),this.$router.push({name:"invoices.list",params:{createdInvoiceId:this.createdInvoice.id}})})).catch((e=>{this.loading=!1,console.log(e.response.data.errors)})):(this.loading=!1,alert("Discount is bigger than the total taxable amount. Please change it to save invoice!"))},add(){this.items.push({id:Date.now()})},remove(e){const t=this.items.indexOf(e);-1!==t&&this.items.splice(t,1)},setDisabled:(e,t)=>!e.items||!e.items[t]||(!e.items[t].hasOwnProperty("name")||!e.items[t].name),setTotal(e,t){if(e){const s=e.items[t];let a=s.quantity*s.price;const o=`items[${t}]`;if(1==s.inclusive){const e=s.unit_price/(s.tax/100+1),t=e*s.quantity,l=(s.unit_price-e)*s.quantity;a=s.unit_price*s.quantity,this.$refs.invoiceForm.setFieldValue(`${o}.total`,a>0?Math.round(a.toFixed(2)).toString():0),this.$refs.invoiceForm.setFieldValue(`${o}.taxable_amount`,t>0?t.toFixed(2):0),this.$refs.invoiceForm.setFieldValue(`${o}.tax_amount`,a>0?l.toFixed(2):0)}else{const e=parseFloat(s.unit_price),t=e*s.quantity,l=e*(s.tax/100),r=l*s.quantity;a=(e+l)*s.quantity,this.$refs.invoiceForm.setFieldValue(`${o}.total`,a>0?Math.round(a.toFixed(2)).toString():0),this.$refs.invoiceForm.setFieldValue(`${o}.taxable_amount`,t>0?t.toFixed(2):0),this.$refs.invoiceForm.setFieldValue(`${o}.tax_amount`,a>0?r.toFixed(2):0)}this.setInvoiceTotals(e)}},setInvoiceTotals(e){let t=0,s=0,a=0;for(let l=0;l<e.items.length;l++)t+=parseFloat(e.items[l].total),s+=parseFloat(e.items[l].taxable_amount),a+=parseFloat(e.items[l].tax_amount);const o=parseFloat(e.discount)>=0?parseFloat(e.discount):0;t=t>=0?t:0,this.total=Math.round(t-o),this.totalTaxable=Math.round(s),this.totalTax=Math.round(a)},setDiscount(e){let t=0;for(let a=0;a<e.items.length;a++)t+=parseFloat(e.items[a].total);const s=parseFloat(e.discount)>=0?parseFloat(e.discount):0;0==s&&this.$refs.invoiceForm.setFieldValue("discount",s.toString()),t=t>=0?t:0,this.total=Math.round(t-parseFloat(s))},setInvoiceData(){this.total=this.editInvoice.total,this.totalTaxable=this.editInvoice.taxable,this.totalTax=this.editInvoice.tax,this.$refs.invoiceForm.setFieldValue("retail",this.editInvoice.retail),this.$refs.invoiceForm.setFieldValue("customer_name",this.editInvoice.customer_name),this.$refs.invoiceForm.setFieldValue("customer_address",this.editInvoice.customer_address),this.$refs.invoiceForm.setFieldValue("customer_gstin",this.editInvoice.customer_gstin),this.$refs.invoiceForm.setFieldValue("customer_pan",this.editInvoice.customer_pan),this.$refs.invoiceForm.setFieldValue("discount",this.editInvoice.discount),this.$refs.invoiceForm.setFieldValue("invoice_no",this.editInvoice.invoice_no),this.$refs.invoiceForm.setFieldValue("state_id",this.editInvoice.state.id),this.$nextTick((()=>{for(let e=0;e<this.editInvoice.items.length;e++){const t=this.editInvoice.items[e];this.$refs.invoiceForm.setFieldValue(`items[${e}].name`,t.name.toString()),this.$refs.invoiceForm.setFieldValue(`items[${e}].quantity`,t.quantity.toString()),this.$refs.invoiceForm.setFieldValue(`items[${e}].unit_price`,t.unit_price.toString()),this.$refs.invoiceForm.setFieldValue(`items[${e}].tax`,t.tax.toString()),this.$refs.invoiceForm.setFieldValue(`items[${e}].tax_amount`,t.tax_amount.toString()),this.$refs.invoiceForm.setFieldValue(`items[${e}].taxable_amount`,t.taxable_amount.toString()),this.$refs.invoiceForm.setFieldValue(`items[${e}].inclusive`,t.inclusive),this.$refs.invoiceForm.setFieldValue(`items[${e}].total`,t.total.toString())}}))}},setup(){b();return{router:g(),toast:Z()}}},nr={key:0},ir={class:"grid md:grid-cols-3 grid-cols-1 gap-4 md:gap-16 pb-8"},dr={class:"col-span-2"},cr={class:"flex justify-between items-center pb-4 mb-4 border-b border-gray-200"},ur=i("h3",{class:"font-bold text-xl text-gray-400"},"Customer details",-1),mr={for:"retail",class:"flex items-center space-x-2"},pr=["checked"],hr=U(),br=i("span",{class:"leading-none font-semibold text-gray-400"},"Retail Customer",-1),gr=["disabled"],fr=i("div",{class:"font-semibold text-xs mr-3"},"Select customer",-1),vr={class:"grid md:grid-cols-2 grid-cols-1 gap-x-4 gap-y-2"},xr=["value","selected"],yr=i("h3",{class:"font-bold text-xl text-gray-400 pb-4 mb-4 border-b border-gray-200"},"Invoice details",-1),wr={class:"grid grid-cols-1 md:grid-cols-2"},_r={class:"mb-32 w-full overflow-x-auto"},Ir={class:"min-w-78"},kr=i("h3",{class:"font-bold text-xl text-gray-400 pb-4 mb-4 border-b border-gray-200"},"Invoice items",-1),Cr={key:0,class:"table-fixed"},Fr={class:"text-left border-b border-gray-100"},Sr=i("th",{class:"w-1/24 py-1"},"#",-1),$r=i("th",{class:"w-6/24 px-2 py-1"},"Item name",-1),Pr=i("th",{class:"w-2/24 px-2 py-1"},"Qty",-1),Tr=i("th",{class:"w-3/24 px-2 py-1"},"Unit price",-1),Dr=i("th",{class:"w-2/24 px-2 py-1"},"Tax%",-1),Vr=i("th",{class:"w-1/24 px-2 py-1"},"Inclusive",-1),Ar=i("th",{class:"w-2/24 px-2 py-1"},"Taxable",-1),Mr=i("th",{class:"w-2/24 px-2 py-1"},"Tax",-1),Er=i("th",{class:"w-2/24 px-2 py-1"},"Total",-1),Ur={class:"w-1/24 px-2 py-1"},Nr={class:"py-2"},qr={class:"flex items-center justify-between"},jr=["onClick"],Rr={class:"p-2"},Lr={class:"p-2"},Gr={class:"p-2"},Br={class:"p-2"},Yr={class:"p-2 text-center"},Or=["name","id","checked"],Zr={class:"p-2 hide-number-control"},zr={class:"p-2 hide-number-control"},Wr={class:"p-2 hide-number-control"},Xr={key:0},Hr=["onClick"],Qr={colspan:"10"},Kr={class:"flex justify-center"},Jr=i("span",{class:"font-semibold"},"Add item",-1),en={class:"flex justify-end items-center"},tn=i("div",{class:"p-4 font-bold text-right"},"Discount",-1),sn={class:"p-4"},an={class:"w-48"},on={class:"flex justify-end"},ln={class:"w-1/12 py-2 mr-3 font-bold text-lg"},rn=i("p",{class:"text-sm font-semibold"},"Taxable",-1),nn={class:"w-1/12 py-2 mr-3 font-bold text-lg"},dn=i("p",{class:"text-sm font-semibold"},"Tax total",-1),cn={class:"w-1/12 py-2 font-bold text-lg"},un=i("p",{class:"text-sm font-semibold"},"Invoice Total",-1),mn={class:"z-40 fixed bottom-0 left-0 flex items-center py-4 w-full bg-white border-t-2 border-gray-600"},pn={class:"w-full max-w-7xl m-auto px-4 md:px-0"},hn={type:"submit",class:"btn-primary"},bn=i("div",{class:"px-4"},[i("p",{class:"text-lg font-bold"},"Select a product"),i("p",{class:"text-xs font-semibold text-gray-500"},"Use the search if you dont see the product in the list")],-1),gn={class:"px-4 py-3"},fn=i("div",{class:"text-xs font-semibold text-blue-600 mb-1"},"Search products",-1),vn={class:"p-2 rounded-md bg-gray-100 w-full",type:"text",placeholder:"Product name"},xn={key:0,class:"px-4 w-full text-left text-sm grid grid-cols-3 gap-2"},yn=["onClick"],wn={key:1,class:"flex justify-center items-center py-12 bg-gray-50 mx-4 rounded-md"},_n=[i("div",{class:"text-sm font-semibold text-gray-400"}," No products found ",-1)],In=i("div",{class:"px-4"},[i("p",{class:"text-lg font-bold"},"Select a customer"),i("p",{class:"text-xs font-semibold text-gray-500"},"Use the search if you dont see the customer in the list")],-1),kn={class:"px-4 py-3"},Cn=i("div",{class:"text-xs font-semibold text-blue-600 mb-1"},"Search customers",-1),Fn={class:"p-2 rounded-md bg-gray-100 w-full",type:"text",placeholder:"Customer name / gstin"},Sn={key:0,class:"px-4 w-full text-left text-sm grid grid-cols-3 gap-2"},$n=["onClick"],Pn={key:1,class:"flex justify-center items-center py-12 bg-gray-50 mx-4 rounded-md"},Tn=[i("div",{class:"text-sm font-semibold text-gray-400"}," No customers found ",-1)];rr.render=function(e,t,s,d,m,p){const h=a("Field"),b=a("DuplicateIcon"),g=a("FormGroup"),f=a("datepicker"),v=a("CogIcon"),x=a("XCircleIcon"),y=a("PlusIcon"),w=a("Form"),S=a("ProductSelectCard"),$=a("Modal"),P=a("CustomerSelectCard"),T=a("Spin"),D=te("debounce");return o(),Y(T,{spinning:e.loading},{default:_((()=>[e.states?(o(),l("div",nr,[r(w,{"validation-schema":e.schema,onSubmit:p.onSubmit,ref:"invoiceForm"},{default:_((({values:a,errors:m})=>[i("div",ir,[i("div",dr,[i("div",cr,[ur,i("div",null,[r(h,{id:"retail",name:"retail",type:"checkbox","unchecked-value":0,value:1},{default:_((({field:e,value:t})=>[i("label",mr,[i("input",le({type:"checkbox"},e,{value:1,name:"retail",id:"retail",checked:t,class:"w-5 h-5"}),null,16,pr),hr,br])])),_:1})]),i("button",{type:"button",onClick:t[0]||(t[0]=C(((...e)=>p.openCustomerSelect&&p.openCustomerSelect(...e)),["prevent"])),class:c(["flex items-center px-3 py-2 rounded bg-blue-100 text-blue-500 hover:bg-blue-200 transition-all ease-in-out duration-200",a.retail?"opacity-30 cursor-not-allowed":""]),disabled:a.retail},[fr,r(b,{class:"w-4 h-4"})],10,gr)]),i("div",vr,[F(r(g,{label:"Customer Name","label-for":"customerName",error:m.customer_name,required:"",class:"md:col-span-2"},{default:_((()=>[r(h,{id:"customerName",name:"customer_name",class:c(["form-control",m.customer_name?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"]),[[pe,!a.retail]]),F(r(g,{label:"Customer Address","label-for":"customerAddress",error:m.customer_address},{default:_((()=>[r(h,{type:"textarea",id:"customerAddress",name:"customer_address"},{default:_((({field:e})=>[i("textarea",le(e,{name:"customer_address",class:["form-control",m.customer_address?"item-form--error":""]}),null,16)])),_:2},1024)])),_:2},1032,["error"]),[[pe,!a.retail]]),r(g,{label:"Customer State","label-for":"customerState",required:"",error:m.state_id,class:"md:col-span-1"},{default:_((()=>[r(h,{id:"customerState",name:"state_id",class:c(m.state_id?"item-form--error":"")},{default:_((({field:t,value:s})=>[i("select",le({id:"customerState",name:"state_id",class:"form-control"},t),[(o(!0),l(I,null,k(e.states,(e=>(o(),l("option",{key:e.id,value:e.id,selected:s==e.id},u(e.name),9,xr)))),128))],16)])),_:2},1032,["class"])])),_:2},1032,["error"]),F(r(g,{label:"Customer GSTIN","label-for":"customerGstin",error:m.customer_gstin,class:"md:col-span-1"},{default:_((()=>[r(h,{id:"customerGstin",name:"customer_gstin",class:c(["form-control",m.customer_gstin?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"]),[[pe,!a.retail]]),F(r(g,{label:"Customer PAN","label-for":"customerPan",error:m.customer_pan,class:"md:col-span-1"},{default:_((()=>[r(h,{id:"customerPan",name:"customer_pan",class:c(["form-control",m.customer_pan?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"]),[[pe,!a.retail]])])]),i("div",null,[yr,i("div",wr,[r(g,{label:"Invoice No","label-for":"invoiceNo",error:m.invoice_no,required:"",class:"md:col-span-2"},{default:_((()=>[r(h,{id:"invoiceNo",name:"invoice_no",class:c(["form-control",m.invoice_no?"item-form--error":""]),disabled:!0},null,8,["class"])])),_:2},1032,["error"]),r(g,{label:"Invoice date","label-for":"invoiceDate",error:m.date,required:"",class:"md:col-span-2"},{default:_((()=>[r(f,{lowerLimit:e.fromDate,upperLimit:e.toDate,modelValue:e.date,"onUpdate:modelValue":t[1]||(t[1]=t=>e.date=t),"input-format":"dd-MM-yyyy"},null,8,["lowerLimit","upperLimit","modelValue"])])),_:2},1032,["error"])])])]),i("div",_r,[i("div",Ir,[kr,i("div",null,[e.items.length?(o(),l("table",Cr,[i("thead",null,[i("tr",Fr,[Sr,$r,Pr,Tr,Dr,Vr,Ar,Mr,Er,i("th",Ur,[r(v,{class:"w-5 h-5 text-gray-400"})])])]),i("tbody",null,[(o(!0),l(I,null,k(e.items,((e,t)=>(o(),l("tr",{key:e.id,class:"border-b border-gray-100"},[i("td",Nr,[i("div",qr,[i("button",{type:"button",onClick:C((e=>p.openProductSelect(a,t)),["prevent"]),class:"p-2 rounded bg-blue-100 text-blue-500 hover:bg-blue-200 transition-all ease-in-out duration-200"},[r(b,{class:"w-4 h-4"})],8,jr)])]),i("td",Rr,[r(h,{id:`name_${t}`,name:`items[${t}].name`,class:c(["item-form",m[`items[${t}].name`]?"item-form--error":""])},null,8,["id","name","class"])]),i("td",Lr,[r(h,{onInput:e=>p.setTotal(a,t),id:`quantity_${t}`,name:`items[${t}].quantity`,type:"number",value:"1",min:"1",class:c(["item-form",m[`items[${t}].quantity`]?"item-form--error":""]),disabled:p.setDisabled(a,t)},null,8,["onInput","id","name","class","disabled"])]),i("td",Gr,[r(h,{onInput:e=>p.setTotal(a,t),id:`unit_price_${t}`,name:`items[${t}].unit_price`,type:"number",min:"0",value:"0",class:c(["item-form",m[`items[${t}].unit_price`]?"item-form--error":""]),disabled:p.setDisabled(a,t)},null,8,["onInput","id","name","class","disabled"])]),i("td",Br,[r(h,{onInput:e=>p.setTotal(a,t),id:`tax_${t}`,name:`items[${t}].tax`,type:"number",min:"0",value:"0",class:c(["item-form",m[`items[${t}].tax`]?"item-form--error":""]),disabled:p.setDisabled(a,t)},null,8,["onInput","id","name","class","disabled"])]),i("td",Yr,[r(h,{onChange:e=>p.setTotal(a,t),id:`inclusive_${t}`,name:`items[${t}].inclusive`,type:"checkbox","unchecked-value":0,value:1},{default:_((({field:e,value:s})=>[i("input",le({type:"checkbox"},e,{value:1,name:`items[${t}].inclusive`,id:`inclusive_${t}`,checked:s,class:"w-5 h-5"}),null,16,Or)])),_:2},1032,["onChange","id","name"])]),i("td",Zr,[r(h,{id:`taxable_amount_${t}`,name:`items[${t}].taxable_amount`,type:"number",value:"0",class:"item-form",disabled:!0},null,8,["id","name"])]),i("td",zr,[r(h,{id:`tax_amount_${t}`,name:`items[${t}].tax_amount`,type:"number",value:"0",class:"item-form",disabled:!0},null,8,["id","name"])]),i("td",Wr,[r(h,{id:`total_${t}`,name:`items[${t}].total`,class:"item-form",disabled:!0},null,8,["id","name"])]),i("td",null,[0!==t?(o(),l("div",Xr,[i("button",{type:"button",onClick:t=>p.remove(e),class:"p-2"},[r(x,{class:"w-5 h-5 text-red-500"})],8,Hr)])):n("",!0)])])))),128)),i("tr",null,[i("td",Qr,[i("div",Kr,[i("button",{type:"button",onClick:t[2]||(t[2]=(...e)=>p.add&&p.add(...e)),class:"w-full flex justify-center items-center text-sm border-2 border-dashed border-gray-200 bg-white hover:bg-gray-100 hover:border-blue-500 transition-all ease-in-out duration-200 rounded-md px-4 py-3"},[r(y,{class:"w-4 h-4 mr-2"}),Jr])])])])])])):n("",!0)]),i("div",null,[i("div",en,[tn,i("div",sn,[i("div",an,[r(h,{onChange:e=>p.setDiscount(a),id:"discount",name:"discount",type:"number",value:"0",min:"0",class:"item-form"},null,8,["onChange"])])])]),i("div",on,[i("div",ln,[rn,i("p",null,"₹"+u(e.totalTaxable),1)]),i("div",nn,[dn,i("p",null,"₹"+u(e.totalTax),1)]),i("div",cn,[un,i("p",null,"₹"+u(e.total),1)])])])])]),i("div",mn,[i("div",pn,[i("button",hn,u(s.editInvoice?"Update Invoice":"Create Invoice"),1),i("button",{onClick:t[3]||(t[3]=C((e=>d.router.back()),["prevent"])),type:"button",class:"btn-secondary ml-4"},"Cancel")])])])),_:1},8,["validation-schema","onSubmit"])])):n("",!0),i("div",null,[r($,{modelValue:e.showProductModal,"onUpdate:modelValue":t[4]||(t[4]=t=>e.showProductModal=t),onCancel:p.handleModalClose},{default:_((()=>[bn,i("div",gn,[fn,F(i("input",vn,null,512),[[D,p.updateSearch,"300ms"]])]),e.products.length?(o(),l("div",xn,[(o(!0),l(I,null,k(e.products,(e=>(o(),l("div",{key:e.id,class:"w-full rounded-md border border-white bg-gray-50 group hover:bg-blue-50 hover:border-blue-400 transition-all ease-in-out duration-200"},[i("button",{onClick:t=>p.handleProductSelect(e),class:"w-full text-left px-2 py-1"},[r(S,{product:e},null,8,["product"])],8,yn)])))),128))])):(o(),l("div",wn,_n))])),_:1},8,["modelValue","onCancel"])]),i("div",null,[r($,{modelValue:e.showCustomerModal,"onUpdate:modelValue":t[5]||(t[5]=t=>e.showCustomerModal=t),onCancel:p.handleCustomerModalClose},{default:_((()=>[In,i("div",kn,[Cn,F(i("input",Fn,null,512),[[D,p.updateCustomerSearch,"300ms"]])]),e.customers.length?(o(),l("div",Sn,[(o(!0),l(I,null,k(e.customers,(e=>(o(),l("div",{key:e.id,class:"w-full rounded-md border border-white bg-gray-50 group hover:bg-blue-50 hover:border-blue-400 transition-all ease-in-out duration-200"},[i("button",{onClick:t=>p.handleCustomerSelect(e),class:"w-full text-left px-2 py-1"},[r(P,{customer:e},null,8,["customer"])],8,$n)])))),128))])):(o(),l("div",Pn,Tn))])),_:1},8,["modelValue","onCancel"])])])),_:1},8,["spinning"])};const Dn={components:{FormLayout:$l,InvoiceForm:rr}};Dn.render=function(e,t,s,l,n,i){const d=a("InvoiceForm"),c=a("FormLayout");return o(),Y(c,{"header-text":"Create a new invoice","max-width":"max-w-7xl"},{default:_((()=>[r(d)])),_:1})};const Vn={components:{FormLayout:$l,InvoiceForm:rr,Spin:Pe},mounted(){this.getInvoice(this.$route.params.invoiceId)},data:()=>({loading:!1,invoice:null}),methods:{getInvoice(t){this.loading=!0,e.get(`/api/invoices/${t}`).then((e=>{this.loading=!1,this.invoice=e.data.data}))}}};Vn.render=function(e,t,s,l,i,d){const c=a("InvoiceForm"),u=a("Spin"),m=a("FormLayout");return o(),Y(m,{"header-text":"Edit invoice","max-width":"max-w-7xl"},{default:_((()=>[r(u,{spinning:i.loading},{default:_((()=>[i.invoice?(o(),Y(c,{key:0,editInvoice:i.invoice},null,8,["editInvoice"])):n("",!0)])),_:1},8,["spinning"])])),_:1})};const An={components:{InvoiceDetails:ka},mounted(){this.getInvoice(this.$route.params.invoiceId)},data:()=>({loading:!1,invoice:null}),methods:{getInvoice(t){this.loading=!0,e.get(`/api/invoices/${t}`).then((e=>{this.loading=!1,this.invoice=e.data.data,this.$nextTick((()=>{setTimeout((()=>{window.print(),this.$router.back()}),1e3)}))}))}}},Mn={key:0,class:"p-2 min-h-full max-w-7xl m-auto"};An.render=function(e,t,s,i,d,c){const u=a("InvoiceDetails");return d.invoice?(o(),l("div",Mn,[r(u,{invoice:d.invoice,"is-print":!0},null,8,["invoice"])])):n("",!0)};const En={components:{CalendarIcon:X,XIcon:R},props:{customer:{type:Object,required:!0}},methods:{moment:B}},Un={href:"javascript:void;",class:"group"},Nn={class:"md:-mx-4 bg-white group-hover:bg-blue-50 border border-white group-hover:border rounded-md group-hover:border-blue-500 transition-all ease-in-out duration-200"},qn={class:"w-full flex pb-1"},jn={class:"px-4 py-1 w-5/12 hover:border-r group-hover:border-blue-500"},Rn={class:"text-lg font-semibold capitalize"},Ln={class:"leading-none text-xs text-gray-500 mt-1 uppercase tracking-wider"},Gn=U(" GSTIN: "),Bn={class:"bg-blue-50 font-bold rounded-md px-1"},Yn={class:"leading-none text-xs text-gray-500 mt-1 uppercase tracking-wider"},On=U(" PAN: "),Zn={class:"bg-yellow-50 font-bold rounded-md px-1"},zn={class:"px-4 py-1 w-5/12 hover:border-r group-hover:border-blue-500 leading-none"},Wn=i("p",{class:"text-xs font-semibold"},"Address",-1),Xn={class:"text-sm text-gray-500 mt-1"},Hn={class:"text-xs text-blue-500 font-semibold"},Qn={class:"px-4 py-1 w-3/12"},Kn=i("p",{class:"text-xs font-bold text-gray-500"},"State",-1),Jn={class:"font-bold text-lg text-gray-500"};En.render=function(e,t,s,a,r,n){return o(),l("a",Un,[i("div",Nn,[i("div",qn,[i("div",jn,[i("h3",Rn,u(s.customer.name),1),i("div",Ln,[Gn,i("span",Bn,u(s.customer.gstin),1)]),i("div",Yn,[On,i("span",Zn,u(s.customer.pan),1)])]),i("div",zn,[Wn,i("p",Xn,[i("span",Hn,u(s.customer.address),1)])]),i("div",Qn,[Kn,i("div",Jn,u(s.customer.state.name),1)])])])])};const ei=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,ti=/^([a-zA-Z]){5}([0-9]){4}([a-zA-Z]){1}?$/,si={props:{editCustomerId:{default:null},states:{type:Array,required:!0}},components:{FormGroup:Ve,Field:re,Form:ne,ErrorMessage:ie,Spin:Pe,TrashIcon:he},watch:{editCustomerId:function(e){this.$refs.customerForm.resetForm(),e&&this.getCustomerData(e)}},data:()=>({loading:!1,schema:f().shape({name:v().required().label("Customer Name"),address:v().nullable().label("Customer Address"),state_id:v().required().label("Customer State"),gstin:z((()=>v().when(["gstin"],{is:e=>(null==e?void 0:e.length)>0,then:v().matches(ei,"Must be a valid GSTIN number")}).nullable())),pan:z((()=>v().when(["pan"],{is:e=>(null==e?void 0:e.length)>0,then:v().matches(ti,"Must be a valid PAN number")}).nullable()))})}),methods:{getCustomerData(t){this.loading=!0,e.get(`/api/customers/${t}`).then((e=>{this.loading=!1;const t=e.data.data;this.$refs.customerForm.setFieldValue("name",t.name),this.$refs.customerForm.setFieldValue("address",t.address),this.$refs.customerForm.setFieldValue("state_id",t.state_id),this.$refs.customerForm.setFieldValue("gstin",t.gstin),this.$refs.customerForm.setFieldValue("pan",t.pan)})).catch((e=>{this.loading=!1,console.log(e.response)}))},onSubmit(t,{resetForm:s}){this.loading=!0,this.editCustomerId?e.patch(`/api/customers/${this.editCustomerId}`,t).then((e=>{this.loading=!1,s(),this.$emit("saved")})).catch((e=>{this.loading=!1,console.log(e)})):e.post("/api/customers",t).then((e=>{this.loading=!1,s(),this.$emit("saved")})).catch((e=>{this.loading=!1,console.log(e)}))},handleDelete(){window.confirm("Are you sure you want to delete this customer?")&&(this.loading=!0,e.delete(`/api/customers/${this.editCustomerId}`).then((e=>{this.loading=!1,this.$emit("deleted")})).catch((e=>{this.loading=!1,console.log(e.response)})))},handleCancel(){this.$emit("cancel")}},setup(){b();return{router:g()}}},ai={class:"w-full py-6"},oi={class:"grid md:grid-cols-2 grid-cols-1 gap-x-4 gap-y-2"},li=["value","selected"],ri={class:"w-full px-0 pt-6 border-t border-gray-200 flex justify-between md:items-center"},ni={class:""},ii={key:0,class:"pr-3"},di=i("span",{class:"md:block hidden"},"Delete",-1),ci={class:"flex"},ui={type:"submit",class:"btn-primary"};si.render=function(e,t,s,d,m,p){const h=a("Field"),b=a("FormGroup"),g=a("TrashIcon"),f=a("Form"),v=a("Spin");return o(),Y(v,{spinning:e.loading},{default:_((()=>[r(f,{"validation-schema":e.schema,onSubmit:p.onSubmit,ref:"customerForm"},{default:_((({errors:e})=>[i("div",ai,[i("div",oi,[r(b,{label:"Customer Name","label-for":"customerName",error:e.name,required:"",class:"md:col-span-2"},{default:_((()=>[r(h,{id:"customerName",name:"name",class:c(["form-control",e.name?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"]),r(b,{label:"Customer Address","label-for":"customerAddress",error:e.address,class:"md:col-span-1"},{default:_((()=>[r(h,{type:"textarea",id:"customerAddress",name:"address"},{default:_((({field:t})=>[i("textarea",le(t,{name:"address",class:["form-control",e.address?"item-form--error":""]}),null,16)])),_:2},1024)])),_:2},1032,["error"]),r(b,{label:"Customer State","label-for":"customerState",required:"",error:e.state_id,class:"md:col-span-1"},{default:_((()=>[r(h,{id:"customerState",name:"state_id",class:c(e.state_id?"item-form--error":"")},{default:_((({field:e,value:t})=>[i("select",le({id:"customerState",name:"state_id",class:"form-control"},e),[(o(!0),l(I,null,k(s.states,(e=>(o(),l("option",{key:e.id,value:e.id,selected:t==e.id},u(e.name),9,li)))),128))],16)])),_:2},1032,["class"])])),_:2},1032,["error"]),r(b,{label:"Customer GSTIN","label-for":"customerGstin",error:e.gstin,class:"md:col-span-1"},{default:_((()=>[r(h,{id:"customerGstin",name:"gstin",class:c(["form-control",e.gstin?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"]),r(b,{label:"Customer PAN","label-for":"customerPan",error:e.pan,class:"md:col-span-1"},{default:_((()=>[r(h,{id:"customerPan",name:"pan",class:c(["form-control",e.pan?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"])])]),i("div",ri,[i("div",ni,[s.editCustomerId?(o(),l("div",ii,[i("button",{class:"btn-danger",onClick:t[0]||(t[0]=C(((...e)=>p.handleDelete&&p.handleDelete(...e)),["prevent"]))},[r(g,{class:"w-4 h-4 md:hidden"}),di])])):n("",!0)]),i("div",ci,[i("button",{onClick:t[1]||(t[1]=C(((...e)=>p.handleCancel&&p.handleCancel(...e)),["prevent"])),type:"button",class:"btn-secondary mr-3"},"Cancel"),i("button",ui,u(s.editCustomerId?"Update":"Create"),1)])])])),_:1},8,["validation-schema","onSubmit"])])),_:1},8,["spinning"])};const mi={props:["createdInvoiceId"],components:{AppLayout:ut,Modal:Ml,PlusIcon:P,CustomerCard:En,CustomerForm:si,Spin:Pe,Pagination:Ko},mounted(){this.$route.query.page&&(this.currentPage=parseInt(this.$route.query.page)),e.get("/api/states").then((({data:e})=>{this.states=e.data})).catch((e=>{this.loading=!1,console.log(e)})),this.getCustomers()},data:()=>({search:"",loading:!1,selectedCustomerId:null,showForm:!1,customers:[],states:[],meta:{},currentPage:1}),watch:{search:function(e){this.getCustomers()}},methods:{changePage(e){this.currentPage=e,this.getCustomers(),this.$router.push({query:{page:e}})},updateSearch(e){this.search=e},getCustomers(){this.loading=!0;let t=`/api/customers?page=${this.currentPage}`;this.search&&(t+=`&filter[search]=${this.search}`),e.get(t).then((e=>{this.loading=!1,this.customers=e.data.data,this.meta=e.data.meta,this.currentPage>1&&!this.customers.length&&this.changePage(1)}))},openAddModal(){this.showForm=!0,this.selectedCustomerId=null},selectCustomer(e){this.showForm=!0,this.selectedCustomerId=e},closeForm(){this.showForm=!1,this.selectedCustomerId=null},handleSaved(){this.closeForm(),this.toast.success("Customer saved successfully!"),this.getCustomers()},handleDeleted(){this.closeForm(),this.toast.success("Customer deleted successfully!"),this.getCustomers()}},setup:()=>({toast:Z()})},pi={class:"flex flex-col md:flex-row justify-between md:items-center"},hi=i("h2",{class:"text-xl md:text-3xl font-bold leading-none"},"Customers",-1),bi={class:"md:w-1/2 flex items-center justify-between space-x-2"},gi={class:"flex-1"},fi=i("div",{class:"text-xs font-semibold text-gray-600"},"Search customers",-1),vi={class:"p-2 rounded-md bg-gray-50 w-full",type:"text",placeholder:"Customer name / gstin"},xi={class:"mt-4"},yi={key:0},wi=i("hr",{class:"bg-gray-100"},null,-1),_i={key:1,class:"bg-gray-50 rounded-md"},Ii=[i("div",{class:"flex items-center justify-center w-full h-full py-32"},[i("p",{class:"text-gray-400"},"No Customers found")],-1)],ki={class:"px-4"},Ci={class:"text-lg font-bold"},Fi={class:"px-4 w-full"};mi.render=function(e,t,s,n,d,c){const m=a("PlusIcon"),p=a("CustomerCard"),h=a("Pagination"),b=a("CustomerForm"),g=a("Modal"),f=a("Spin"),v=a("AppLayout"),x=te("debounce");return o(),Y(v,{maxWidth:"max-w-4xl"},{header:_((()=>[i("div",pi,[hi,i("div",bi,[i("div",gi,[fi,F(i("input",vi,null,512),[[x,c.updateSearch,"350ms"]])]),i("div",xi,[i("button",{onClick:t[0]||(t[0]=C(((...e)=>c.openAddModal&&c.openAddModal(...e)),["prevent"])),class:"btn-primary"},[r(m,{class:"w-4 h-4"})])])])])])),default:_((()=>[r(f,{spinning:d.loading},{default:_((()=>[d.customers.length?(o(),l("div",yi,[(o(!0),l(I,null,k(d.customers,(e=>(o(),l("div",{key:e.id},[r(p,{customer:e,onClick:C((t=>c.selectCustomer(e.id)),["prevent"])},null,8,["customer","onClick"]),wi])))),128)),r(h,{currentPage:d.currentPage,meta:d.meta,onChange:c.changePage},null,8,["currentPage","meta","onChange"])])):(o(),l("div",_i,Ii)),i("div",null,[r(g,{modelValue:d.showForm,"onUpdate:modelValue":t[1]||(t[1]=e=>d.showForm=e),onCancel:c.closeForm,class:"md:ml-48"},{default:_((()=>[i("div",ki,[i("p",Ci,u(d.selectedCustomerId?"Update product":"Add a product"),1)]),i("div",Fi,[r(b,{editCustomerId:d.selectedCustomerId,states:d.states,onSaved:c.handleSaved,onDeleted:c.handleDeleted,onCancel:c.closeForm},null,8,["editCustomerId","states","onSaved","onDeleted","onCancel"])])])),_:1},8,["modelValue","onCancel"])])])),_:1},8,["spinning"])])),_:1})};const Si={components:{CalendarIcon:X,XIcon:R},props:{product:{type:Object,required:!0}},methods:{moment:B}},$i={href:"javascript:void;",class:"group"},Pi={class:"md:-mx-4 bg-white group-hover:bg-blue-50 border border-white group-hover:border rounded-md group-hover:border-blue-500 transition-all ease-in-out duration-200"},Ti={class:"w-full flex pb-1"},Di={class:"px-4 py-1 w-6/12 hover:border-r group-hover:border-blue-500"},Vi={class:"text-lg font-semibold capitalize"},Ai={class:"leading-none text-xs text-gray-500 mt-1 uppercase tracking-wider"},Mi={class:"bg-gray-50 rounded-md px-1"},Ei={class:"px-4 py-1 w-3/12 hover:border-r group-hover:border-blue-500 leading-none"},Ui={class:"text-lg font-semibold"},Ni={class:"text-xs text-gray-500 mt-1"},qi={key:0,class:"px-1 rounded-md bg-blue-50 text-xs text-blue-500 font-semibold"},ji={key:1,class:"px-1 rounded-md bg-yellow-50 text-xs text-yellow-500 font-semibold"},Ri={class:"px-4 py-1 w-3/12"},Li=i("p",{class:"text-xs font-bold text-gray-500"},"Tax",-1),Gi={class:"font-bold text-lg text-gray-500"};Si.render=function(e,t,s,a,r,n){return o(),l("a",$i,[i("div",Pi,[i("div",Ti,[i("div",Di,[i("h3",Vi,u(s.product.name),1),i("div",Ai,[i("span",Mi,u(s.product.code),1)])]),i("div",Ei,[i("p",Ui,"₹ "+u(parseFloat(s.product.unit_price)),1),i("p",Ni,[1==s.product.inclusive?(o(),l("span",qi,"Tax inclusive")):(o(),l("span",ji,"Tax exclusive"))])]),i("div",Ri,[Li,i("div",Gi,u(parseFloat(s.product.tax))+"% ",1)])])])])};const Bi={props:{editProductId:{default:null}},components:{FormGroup:Ve,Field:re,Form:ne,ErrorMessage:ie,Spin:Pe,TrashIcon:he},watch:{editProductId:function(e){this.$refs.productForm.resetForm(),e&&this.getProductdata(e)}},data:()=>({loading:!1,schema:f().shape({name:v().required().label("Name"),code:v().nullable().label("Code"),unit_price:v().required().label("unit price"),tax:v().label("Tax %"),inclusive:ue().label("Inclusive")})}),methods:{getProductdata(t){this.loading=!0,e.get(`/api/products/${t}`).then((e=>{this.loading=!1;const t=e.data.data;this.$refs.productForm.setFieldValue("name",t.name),this.$refs.productForm.setFieldValue("code",t.code),this.$refs.productForm.setFieldValue("unit_price",t.unit_price),this.$refs.productForm.setFieldValue("inclusive",t.inclusive),this.$refs.productForm.setFieldValue("tax",t.tax)})).catch((e=>{this.loading=!1,console.log(e.response)}))},onSubmit(t,{resetForm:s}){this.loading=!0,this.editProductId?e.patch(`/api/products/${this.editProductId}`,t).then((e=>{this.loading=!1,s(),this.$emit("saved")})).catch((e=>{this.loading=!1,console.log(e)})):e.post("/api/products",t).then((e=>{this.loading=!1,s(),this.$emit("saved")})).catch((e=>{this.loading=!1,console.log(e)}))},handleDelete(){window.confirm("Are you sure you want to delete this product?")&&(this.loading=!0,e.delete(`/api/products/${this.editProductId}`).then((e=>{this.loading=!1,this.$emit("deleted")})).catch((e=>{this.loading=!1,console.log(e.response)})))},handleCancel(){this.$emit("cancel")}},setup(){b();return{router:g()}}},Yi={class:"w-full py-6"},Oi={class:"grid md:grid-cols-3 grid-cols-1 gap-x-4 gap-y-2"},Zi=["checked"],zi={class:"w-full px-0 pt-6 border-t border-gray-200 flex justify-between md:items-center"},Wi={key:0,class:"pr-3"},Xi=i("span",{class:"md:block hidden"},"Delete",-1),Hi={class:"flex"},Qi={type:"submit",class:"btn-primary"};Bi.render=function(e,t,s,d,m,p){const h=a("Field"),b=a("FormGroup"),g=a("TrashIcon"),f=a("Form"),v=a("Spin");return o(),Y(v,{spinning:e.loading},{default:_((()=>[r(f,{"validation-schema":e.schema,onSubmit:p.onSubmit,ref:"productForm"},{default:_((({errors:e})=>[i("div",Yi,[i("div",Oi,[r(b,{label:"Item name","label-for":"itemName",error:e.name,required:"",class:"md:col-span-2"},{default:_((()=>[r(h,{id:"name",name:"name",class:c(["form-control",e.name?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"]),r(b,{label:"Code","label-for":"code",error:e.code,class:"md:col-span-1"},{default:_((()=>[r(h,{id:"code",name:"code",class:c(["form-control",e.code?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"]),r(b,{label:"Unit Price","label-for":"unitPrice",error:e.unit_price,class:"md:col-span-1"},{default:_((()=>[r(h,{id:"unitPrice",name:"unit_price",type:"number",min:"0",value:"0",class:c(["item-form",e.unit_price?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"]),r(b,{label:"Tax inclusive","label-for":"inclusive",error:e.inclusive},{default:_((()=>[r(h,{id:"inclusive",name:"inclusive",type:"checkbox","unchecked-value":0,value:1},{default:_((({field:e,value:t})=>[i("input",le({type:"checkbox"},e,{value:1,name:"inclusive",id:"inclusive",checked:t,class:"w-5 h-5 mt-2"}),null,16,Zi)])),_:1})])),_:2},1032,["error"]),r(b,{label:"Tax %","label-for":"tax",error:e.tax,class:"md:col-span-1"},{default:_((()=>[r(h,{id:"tax",name:"tax",type:"number",min:"0",value:"0",class:c(["item-form",e.tax?"item-form--error":""])},null,8,["class"])])),_:2},1032,["error"])])]),i("div",zi,[i("div",null,[s.editProductId?(o(),l("div",Wi,[i("button",{class:"btn-danger",onClick:t[0]||(t[0]=C(((...e)=>p.handleDelete&&p.handleDelete(...e)),["prevent"]))},[r(g,{class:"w-4 h-4 md:hidden"}),Xi])])):n("",!0)]),i("div",Hi,[i("button",{onClick:t[1]||(t[1]=C(((...e)=>p.handleCancel&&p.handleCancel(...e)),["prevent"])),type:"button",class:"btn-secondary mr-3"},"Cancel"),i("button",Qi,u(s.editProductId?"Update":"Create"),1)])])])),_:1},8,["validation-schema","onSubmit"])])),_:1},8,["spinning"])};const Ki={components:{Spin:Pe,FilePond:be(ge),ExclamationCircleIcon:fe},data:()=>({loading:!1,file:[],errors:[]}),methods:{handleFilePondInit(){console.log("FilePond has initialized")},handleFilePondUpdateFile(e){this.file=e.map((e=>e.file))},handleUpload(){this.loading=!0,this.errors=[];const t=new FormData;t.append("file",this.file[0]),e.post("/api/products/upload",t).then((e=>{this.loading=!1,this.$refs.pond.removeFile(this.file[0]),this.file=[],this.$emit("uploaded")})).catch((e=>{this.loading=!1,this.errors=e.response.data.errors,console.log(e)}))},handleCancel(){this.file=[],this.errors=[],this.$refs.pond.removeFile(this.file[0]),this.$emit("cancel")}},setup(){b();return{router:g()}}},Ji=i("div",{class:"pt-6 pb-4"},[i("p",{class:"font-semibold"},[U("Download the csv template to bulk upload your products. "),i("a",{class:"ml-2 p-1 rounded bg-blue-50 text-blue-500",href:"/assets/bulk_products_uploader.csv",download:""},"Download")]),i("p",{class:"text-yellow-500"},"After filling in the products in the downloaded template, upload the file using the form below."),i("span",{class:"bg-red-50 text-red-500 text-sm px-2 rounded-md font-semibold"},"In the sheet, for the Tax Inclusive field, please enter 1 for Yes and 0 for No.")],-1),ed={key:0,class:"flex bg-red-50 text-sm text-red-600 rounded-md p-2"},td={class:"ml-4 flex-1"},sd=i("p",{class:"font-semibold"},"Please check the CSV file for the following errors.",-1),ad={class:"rounded-md bg-red-500 text-white px-1 text-xs"},od={class:"py-6"},ld={class:"w-full px-0 pt-6 border-t border-gray-200 flex justify-between md:items-center"},rd={class:"flex"},nd=["disabled"];Ki.render=function(e,t,s,d,c,m){const p=a("ExclamationCircleIcon"),h=a("file-pond"),b=a("Spin");return o(),Y(b,{spinning:e.loading},{default:_((()=>[Ji,e.errors.length?(o(),l("div",ed,[r(p,{class:"w-8 h-8"}),i("div",td,[sd,(o(!0),l(I,null,k(e.errors,((e,t)=>(o(),l("div",{key:e,class:"mr-4"},[i("span",ad,u(t+1),1),U(" "+u(e),1)])))),128))])])):n("",!0),i("div",od,[r(h,{name:"upload",ref:"pond","class-name":"my-pond","label-idle":"Click to Select file or Drop files here...","allow-multiple":!1,"accepted-file-types":".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onInit:m.handleFilePondInit,onUpdatefiles:m.handleFilePondUpdateFile},null,8,["onInit","onUpdatefiles"])]),i("div",ld,[i("div",rd,[i("button",{onClick:t[0]||(t[0]=C(((...e)=>m.handleCancel&&m.handleCancel(...e)),["prevent"])),type:"button",class:"btn-secondary mr-3"},"Cancel"),i("button",{onClick:t[1]||(t[1]=C(((...e)=>m.handleUpload&&m.handleUpload(...e)),["prevent"])),class:"btn-primary",disabled:!e.file.length},"Upload",8,nd)])])])),_:1},8,["spinning"])};const id={props:["createdInvoiceId"],components:{AppLayout:ut,Modal:Ml,PlusIcon:P,UploadIcon:ve,ProductCard:Si,ProductForm:Bi,ProductUploadForm:Ki,Spin:Pe,Pagination:Ko},mounted(){this.$route.query.page&&(this.currentPage=parseInt(this.$route.query.page)),this.getProducts()},data:()=>({search:"",loading:!1,selectedProductId:null,showForm:!1,showUploadForm:!1,products:[],meta:{},currentPage:1}),watch:{search:function(e){this.getProducts()}},methods:{changePage(e){this.currentPage=e,this.getProducts(),this.$router.push({query:{page:e}})},updateSearch(e){this.search=e},getProducts(){this.loading=!0;let t=`/api/products?page=${this.currentPage}`;this.search&&(t+=`&filter[search]=${this.search}`),e.get(t).then((e=>{this.loading=!1,this.products=e.data.data,this.meta=e.data.meta,this.currentPage>1&&!this.products.length&&this.changePage(1)}))},openAddModal(){this.showForm=!0,this.selectedProductId=null},openUploadModal(){this.showUploadForm=!0},selectProduct(e){this.showForm=!0,this.selectedProductId=e},closeForm(){this.showForm=!1,this.selectedProductId=null},closeUploadForm(){this.showUploadForm=!1},handleSaved(){this.closeForm(),this.toast.success("Product saved successfully!"),this.getProducts()},handleUploaded(){this.closeUploadForm(),this.toast.success("Products uploaded successfully!"),this.getProducts()},handleDeleted(){this.closeForm(),this.toast.success("Products deleted successfully!"),this.getProducts()}},setup:()=>({toast:Z()})},dd={class:"flex flex-col md:flex-row justify-between md:items-center"},cd=i("h2",{class:"text-xl md:text-3xl font-bold leading-none"},"Products",-1),ud={class:"md:w-2/3 flex items-center justify-between space-x-2"},md={class:"flex-1"},pd=i("div",{class:"text-xs font-semibold text-gray-600"},"Search products",-1),hd={class:"p-2 rounded-md bg-gray-50 w-full",type:"text",placeholder:"Product name / code"},bd={class:"mt-4 space-x-2"},gd={key:0},fd=i("hr",{class:"bg-gray-100"},null,-1),vd={key:1,class:"bg-gray-50 rounded-md"},xd=[i("div",{class:"flex items-center justify-center w-full h-full py-32"},[i("p",{class:"text-gray-400"},"No Products found")],-1)],yd={class:"px-4"},wd={class:"text-lg font-bold"},_d={class:"px-4 w-full"},Id=i("div",{class:"px-4"},[i("p",{class:"text-lg font-bold"},"Bulk upload products")],-1),kd={class:"px-4 w-full"};id.render=function(e,t,s,n,d,c){const m=a("PlusIcon"),p=a("UploadIcon"),h=a("ProductCard"),b=a("Pagination"),g=a("ProductForm"),f=a("Modal"),v=a("ProductUploadForm"),x=a("Spin"),y=a("AppLayout"),w=te("debounce");return o(),Y(y,{maxWidth:"max-w-3xl"},{header:_((()=>[i("div",dd,[cd,i("div",ud,[i("div",md,[pd,F(i("input",hd,null,512),[[w,c.updateSearch,"350ms"]])]),i("div",bd,[i("button",{onClick:t[0]||(t[0]=C(((...e)=>c.openAddModal&&c.openAddModal(...e)),["prevent"])),class:"btn-primary"},[r(m,{class:"w-4 h-4"})]),i("button",{onClick:t[1]||(t[1]=C(((...e)=>c.openUploadModal&&c.openUploadModal(...e)),["prevent"])),class:"btn-secondary"},[r(p,{class:"w-4 h-4"})])])])])])),default:_((()=>[r(x,{spinning:d.loading},{default:_((()=>[d.products.length?(o(),l("div",gd,[(o(!0),l(I,null,k(d.products,(e=>(o(),l("div",{key:e.id},[r(h,{product:e,onClick:C((t=>c.selectProduct(e.id)),["prevent"])},null,8,["product","onClick"]),fd])))),128)),r(b,{currentPage:d.currentPage,meta:d.meta,onChange:c.changePage},null,8,["currentPage","meta","onChange"])])):(o(),l("div",vd,xd)),i("div",null,[r(f,{modelValue:d.showForm,"onUpdate:modelValue":t[2]||(t[2]=e=>d.showForm=e),onCancel:c.closeForm,class:"md:ml-48"},{default:_((()=>[i("div",yd,[i("p",wd,u(d.selectedProductId?"Update product":"Add a product"),1)]),i("div",_d,[r(g,{editProductId:d.selectedProductId,onSaved:c.handleSaved,onDeleted:c.handleDeleted,onCancel:c.closeForm},null,8,["editProductId","onSaved","onDeleted","onCancel"])])])),_:1},8,["modelValue","onCancel"])]),i("div",null,[r(f,{modelValue:d.showUploadForm,"onUpdate:modelValue":t[3]||(t[3]=e=>d.showUploadForm=e),onCancel:c.closeUploadForm,class:"md:ml-48"},{default:_((()=>[Id,i("div",kd,[r(v,{onUploaded:c.handleUploaded,onCancel:c.closeUploadForm},null,8,["onUploaded","onCancel"])])])),_:1},8,["modelValue","onCancel"])])])),_:1},8,["spinning"])])),_:1})};const Cd=[{name:"login",path:"/auth/login",component:Ue},{name:"dashboard",path:"/dashboard",component:gs},{name:"settings",path:"/settings",component:Ws},{name:"invoices.list",path:"/invoices",component:rl,props:!0},{name:"invoices.create",path:"/invoices/create",component:Dn},{name:"invoices.edit",path:"/invoices/update/:invoiceId",component:Vn,props:!0},{name:"invoices.print",path:"/invoices/print/:invoiceId",component:An,props:!0},{name:"customers.list",path:"/customers",component:mi},{name:"products.list",path:"/products",component:id}],Fd=xe({history:ye(),routes:Cd});Fd.beforeEach(((e,t,s)=>{"/"===e.path&&s({name:"login"}),"login"===e.name||$e.getters["user/authenticated"]?"login"===e.name&&$e.getters["user/authenticated"]?s({name:"dashboard"}):s():s({name:"login"})}));var Sd=m({name:"App",components:{}});Sd.render=function(e,t,s,l,n,i){const d=a("router-view");return o(),Y(d,null,{default:_((({Component:e,route:t})=>[r(_e,{name:"fade"},{default:_((()=>[(o(),Y(we(e),{key:t.path}))])),_:2},1024)])),_:1})};const $d={install(e,t={}){e.config.globalProperties.$htmlToPaper=(e,s,a=(()=>!0))=>{let o="_blank",l=["fullscreen=yes","titlebar=yes","scrollbars=yes"],r=!0,n=[],{name:i=o,specs:d=l,replace:c=r,styles:u=n}=t;s&&(s.name&&(i=s.name),s.specs&&(d=s.specs),s.replace&&(c=s.replace),s.styles&&(u=s.styles)),d=d.length?d.join(","):"";const m=window.document.getElementById(e);if(!m)return void alert(`Element to print #${e} not found!`);const p=window.open("",i,d,c);return p.document.write(`\n          <html>\n            <head>\n              <title>${window.document.title}</title>\n            </head>\n            <body>\n              ${m.innerHTML}\n            </body>\n          </html>\n        `),function(e,t){t.forEach((t=>{let s=e.document.createElement("link");s.setAttribute("rel","stylesheet"),s.setAttribute("type","text/css"),s.setAttribute("href",t),e.document.getElementsByTagName("head")[0].appendChild(s)}))}(p,u),setTimeout((()=>{p.document.close(),p.focus(),p.print(),p.close(),a()}),1e3),!0}}};e.defaults.baseURL={}.VITE_APP_API_BASE_URL,e.defaults.withCredentials=!0,$e.dispatch("user/authenticate").then((()=>{const e=Ie(Sd);e.use(Fd),e.use($e),e.use($d,{name:"_blank",specs:["fullscreen=yes","titlebar=yes","scrollbars=yes"],styles:[],timeout:500,autoClose:!0,windowTitle:window.document.title}),e.use(ke,{defaultTime:"350ms"}),e.use(Ce({key:"$vfm",componentName:"VueFinalModal",dynamicContainerName:"ModalsContainer"})),e.use(Fe,{position:Se.TOP_RIGHT,timeout:3e3}),e.mount("#app")}));e.interceptors.response.use((e=>e),(e=>{const{status:t}=e.response;return 401===t&&location.reload(!0),Promise.reject(e)}));
